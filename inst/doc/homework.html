<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19037" />


<title>All Homework</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All Homework</h1>
<h4 class="author">19037</h4>
<h4 class="date">2020/01/03</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This rmarkdown is a summary of homework.</p>
</div>
<div id="section" class="section level1">
<h1>1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>The allbacks data frame gives measurements on the volume and weight of 15 books, some of which are softback (pb) and some of which are hardback (hb). Use knitr to produce at least 3 examples(xtables,figures,texts).</p>
<div id="answer" class="section level3">
<h3>answer</h3>
<p>First,as following,the allbacks data will be represented in the table directly.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">library</span>(xtable)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">data</span>(allbacks)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">print</span>(<span class="kw">xtable</span>(allbacks[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>, ]),<span class="dt">type=</span><span class="st">&#39;html&#39;</span>)</a></code></pre></div>
<!-- html table generated in R 3.6.2 by xtable 1.8-4 package -->
<!-- Tue Dec 31 13:27:59 2019 -->
<table border="1">
<tr>
<th>
</th>
<th>
volume
</th>
<th>
area
</th>
<th>
weight
</th>
<th>
cover
</th>
</tr>
<tr>
<td align="right">
1
</td>
<td align="right">
885.00
</td>
<td align="right">
382.00
</td>
<td align="right">
800.00
</td>
<td>
hb
</td>
</tr>
<tr>
<td align="right">
2
</td>
<td align="right">
1016.00
</td>
<td align="right">
468.00
</td>
<td align="right">
950.00
</td>
<td>
hb
</td>
</tr>
<tr>
<td align="right">
3
</td>
<td align="right">
1125.00
</td>
<td align="right">
387.00
</td>
<td align="right">
1050.00
</td>
<td>
hb
</td>
</tr>
<tr>
<td align="right">
4
</td>
<td align="right">
239.00
</td>
<td align="right">
371.00
</td>
<td align="right">
350.00
</td>
<td>
hb
</td>
</tr>
<tr>
<td align="right">
5
</td>
<td align="right">
701.00
</td>
<td align="right">
371.00
</td>
<td align="right">
750.00
</td>
<td>
hb
</td>
</tr>
<tr>
<td align="right">
6
</td>
<td align="right">
641.00
</td>
<td align="right">
367.00
</td>
<td align="right">
600.00
</td>
<td>
hb
</td>
</tr>
<tr>
<td align="right">
7
</td>
<td align="right">
1228.00
</td>
<td align="right">
396.00
</td>
<td align="right">
1075.00
</td>
<td>
hb
</td>
</tr>
<tr>
<td align="right">
8
</td>
<td align="right">
412.00
</td>
<td align="right">
0.00
</td>
<td align="right">
250.00
</td>
<td>
pb
</td>
</tr>
<tr>
<td align="right">
9
</td>
<td align="right">
953.00
</td>
<td align="right">
0.00
</td>
<td align="right">
700.00
</td>
<td>
pb
</td>
</tr>
<tr>
<td align="right">
10
</td>
<td align="right">
929.00
</td>
<td align="right">
0.00
</td>
<td align="right">
650.00
</td>
<td>
pb
</td>
</tr>
<tr>
<td align="right">
11
</td>
<td align="right">
1492.00
</td>
<td align="right">
0.00
</td>
<td align="right">
975.00
</td>
<td>
pb
</td>
</tr>
<tr>
<td align="right">
12
</td>
<td align="right">
419.00
</td>
<td align="right">
0.00
</td>
<td align="right">
350.00
</td>
<td>
pb
</td>
</tr>
<tr>
<td align="right">
13
</td>
<td align="right">
1010.00
</td>
<td align="right">
0.00
</td>
<td align="right">
950.00
</td>
<td>
pb
</td>
</tr>
<tr>
<td align="right">
14
</td>
<td align="right">
595.00
</td>
<td align="right">
0.00
</td>
<td align="right">
425.00
</td>
<td>
pb
</td>
</tr>
<tr>
<td align="right">
15
</td>
<td align="right">
1034.00
</td>
<td align="right">
0.00
</td>
<td align="right">
725.00
</td>
<td>
pb
</td>
</tr>
</table>
<p>Table which is presented above gives measurements on the volume and weight of 15 books, some of which are softback (pb) and some of which are hardback (hb).We can enter these columns of data,then plot volume against weight to give Figure,thus:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">attach</span>(allbacks)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">plot</span>(volume,weight)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">detach</span>(allbacks)</a></code></pre></div>
</div>
</div>
</div>
<div id="section-1" class="section level1">
<h1>2</h1>
<div id="exercise-3.4" class="section level2">
<h2>Exercise 3.4</h2>
<p>The Rayleigh density [156, Ch. 18] is <span class="math inline">\(f(x)=x/(\sigma^2)*exp(-x^2/(2*\sigma^2)),x\geq 0,\sigma&gt; 0\)</span> Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma&gt;0\)</span> and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span> (check the histogram).</p>
<div id="answer-1" class="section level3">
<h3>answer</h3>
<p>Here <span class="math inline">\(F_{X}(x)=1-exp(-x^2/(2*\sigma^2))\)</span> for 0 <span class="math inline">\(x&gt;0\)</span>, and <span class="math inline">\(F_{X}(u)=sqrt(-2*(sigma^2)*log(1-u))\)</span>. Generate all n required random uniform numbers as vector u. Then <span class="math inline">\(u^(1/3)\)</span> is a vector of length n containing the sample <span class="math inline">\(x1,...,xn\)</span>. In this exercise, I choose <span class="math inline">\(\sigma\)</span> as 2,4,6,8.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">n &lt;-<span class="st"> </span><span class="dv">100000</span></a>
<a class="sourceLine" id="cb6-2" title="2">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb6-3" title="3">m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="cf">for</span>(sigma <span class="cf">in</span> m){</a>
<a class="sourceLine" id="cb6-6" title="6">x &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#density histogram of sample</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma = &quot;</span>,sigma))</a>
<a class="sourceLine" id="cb6-9" title="9">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="fl">.001</span>)</a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#density curve f(x)</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="kw">lines</span>(y, y<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))) </a>
<a class="sourceLine" id="cb6-12" title="12">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The histogram and density plot in figure that we polted suggests that the empirical and theoretical distributions approximately agree.</p>
</div>
</div>
<div id="exercise-3.11" class="section level2">
<h2>Exercise 3.11</h2>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}=1-p_{1}\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_{1}=0.75\)</span>. Repeat with different values for <span class="math inline">\(p_{1}\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_{1}\)</span> that produce bimodal mixtures.</p>
<div id="answer-2" class="section level3">
<h3>answer</h3>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}=1-p_{1}\)</span>. In this exercise, except for p=0.75 as required, I choose p=0.1, 0.3, 0.5, 0.6, 0.9.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">n &lt;-<span class="st"> </span><span class="fl">1e6</span></a>
<a class="sourceLine" id="cb7-2" title="2">l &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.75</span>,<span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#par(mfrow=c(2,3))</span></a>
<a class="sourceLine" id="cb7-4" title="4"> <span class="cf">for</span>(p <span class="cf">in</span> l){</a>
<a class="sourceLine" id="cb7-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(p, <span class="dv">1</span><span class="op">-</span>p))</a>
<a class="sourceLine" id="cb7-6" title="6">  y &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">length=</span>n)</a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb7-8" title="8">    <span class="cf">if</span>(x[i] <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb7-9" title="9">    y[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-10" title="10">    <span class="cf">else</span> y[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">3</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-11" title="11">  }</a>
<a class="sourceLine" id="cb7-12" title="12"> <span class="kw">hist</span>(y, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;p = &quot;</span>, p))</a>
<a class="sourceLine" id="cb7-13" title="13">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAjVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6Ojo6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmtttmtv+QOgCQZgCQZjqQttuQ27aQ2/+2ZgC2Zjq227a22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb2//b////tmb/25D/27b//7b//9v////s3NwYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIPElEQVR4nO2da3vaNhiGTbaErttMujXpurrLNu8QM/D//3mzLEgISH4kWcKv7Of+wFWCDuauDtbBomjJIMXUFyAdCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCJCRoP3Xolj9/Pz6/pei+OZj6lzzEbR/LBR3x/e7Tf/+h8TZ5iOoLlaf27+K4uHwvipWX5S0h8FYo5EgqCpufvupKL59OrzfrgvN6stroM7F3fFV0RWguz7o3UV6UZEh6K0Po6BOSNmHvX0+Bir7v94+n6cXFSGCbp7av1/aF6MgLUSVtj9P3ncl6vA+FUIEPbQn393IuSBdxbrXRQjqv2T9psSccy5IN9Kq8C1GUHPskZyq2Euo5Qh6KUFOjXTb/vehWP34aSGN9Js2yNbNdypeu3mNbolSIkTQm17MTFfAPuobxd5VN/DoIg23WzEQIsihNXkdaujC1OhIZeKLkyHo5o9u4Pn903Cw/de1HqxqQe0/H7q778+pL06IoLQ90RgoCEBBAAoCSBAkGgoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQBxBxQtRkpOE3zc6bKS07+eJIkiUa6/LqI97Shvb5tKR3+pUTYaC9o/l8Z+1ZX/7WEEXr5Pjcxm7zcvTfY2lki1bEEsQoj4+IJqsDbp4nRy/yzg8aWx/wmbpglInR0FO0XMX1BT2Z5CWLqgqinL7/vm0wx+TnCV6voKqrnGu+tLDbt5EX26275Qg3iia2G3K7nX/b8sSZKE+lhut6iSVSNMduQtqa919NdYjV5YuKHVyFOQUfQ6CavZikyRHQU7RKQhEz1hQ6lWNN4JkLG5IWdW4XM8oRqYYCSlz0pdqMhSUclVDviCHo4qWXoJqeBpPwlWNHAS12FG6VY1MBGlF/keNjJ/uyEOQOvVKHREWfrDcnAWp6qPN2Loor+SCIkoWtNvEOE9uzoLutZ8RxaddhCDbTI9ncmER5QqqXvuhMkJyoRHlCnotQZGSC4soWdDEyVGQU0Sxgnab8jiKGHdk31wFTZ8cBTlFFC1IrbfXAwN1z+SCIooWVN0+b9d3bTXqhO8ZC1LzqWpTQtBQYwnTHUpQ1ckZGGroTS9NkmUf+YK6urXb3D7vNvYq1gvqZ6Pj71HMQFB3I6R+bmmgCVKCDmoWOWkPUYK2617QApd9HFh4CYLr7oc1jbv2co+iIbmg6xAtqHLp3/uGyr4sNmdB1kIRllxYRJOgifd4vLkPiphcWERrCRIgaLCD90/OPYZt44s0QQObn4OS84whX5DDhNlLEHuoGQtyYf+IerqFC8IN1awF9b9ZWpWDwS0N1YjpjnwENasvtRrNl3GS84whX5DaX6dGWNdees5GkLpRVIKuvXkhG0HHElQ5zdrHe5glG0GHNqged7s4Z0H6PnDkLqpZC5omuXkJSvAwSzaC9EBruIVO8TBLLoIq3TjXQxvMkjyKkImg5tg4H1YtjCR5mCUPQSeD0IG1+QWXoJMR2NBQI8XDLLkIgpXnEC76wyzzEmRNJfl0x2RrG3EEnSUXEMOpBFGQYEFwOt4nuYAYwgVNmBwFucWgIEPY056JgmxhKQiEpSAQloJAWAoCYSkIhPUSNMGILC9B3nmMh4IAfrnZVjWCpjuCBV21pnllE3dVY2QJEigo8pz0/ARFXtUYK+g6FS33EiRKULRVjcut0eGCUpcjv6QjrWqEFhTwQRImuQ+iIKdQcxQUaftLfEHpWiLPRrrU/xjbSF+8RilBkwuK1s3PVVCEG0Xbs09xBKWoaVcuQRELiv2DqJo82yDLjeLZaL4QTUJB+EZxfiS8g5gHFAQIFDTumaCcSF+Cpm2RrThffko3wznI/CA4YDAyPSQShA9A8chB5gfBARV4sOqTg8wPggO2TkMNnxxkfhAcsA3dCyvTA0tQ6AfBARV4VcMnB5kfBAfsCRmsyvQg6D4ocygIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDgKoLczkXTNJZTsPrp8NIrg+26MP+4rvopUNeTyK4hqPGYHlHH0DQGQ/vH7o+15ceEzRk03R+NP/JQ92eGOxq6gqD+hE/HsHrS0nACjT62x7yga85AJ2WIoY+6cf0FmisIqm8/OQsa8tC2xrJly2D7znJenTRB3YW6t0H6W1mXBIzn7lsyaG5+35hbLVlVTJV0d0G6iJgLimUq3JZBrZY3zccX2zoCE8kFuZ/uqRgU1BjbaFsG9cpWGFU53K5LtytKLaivM3GqmHkpxZqBbsgMZ7KBdu6MhIL632avD7tNHGv8wMVbDuizZqAtG5rq4Wp8jrAbRWs33w4eMmvKQK8DGwqj/k9wXRsWJsh6ozjcZhgzUI3TyWLwSWhJbVCPz1CjNvcwh5pkqRfmDBrb4KQaGLWcw8EqgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIIF1Qv5eqdtyymwLpgpp+q+qoXzAfh3RBaiOddUv4NZAuSNUxj5NU4iNeUFfHqnLC/MUL2t3/ej9hDZMvaP/43aQHo4oXNPwL7+mRL2jSPiwLQe8nPXpYvqC6nDR76YK264nPrpYuaHIoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEOB/Nn6ekZwzNAUAAAAASUVORK5CYII=" /><!-- --></p>
<p>Graphing the histogram of the sample with density superimposed, which used different values of <span class="math inline">\(p_{1}\)</span>. Make a conjecture about the values of <span class="math inline">\(p_{1}\)</span>, then we can produce bimodal mixtures. And after observing, we can find that the empirical distribution of the mixture appears to be bimodal.</p>
</div>
</div>
<div id="exercise-3.18" class="section level2">
<h2>Exercise 3.18</h2>
<p>Write a function to generate a random sample from a <span class="math inline">\(wd(\sum ,n)\)</span> (Wishart) distribution for <span class="math inline">\(n&gt;d+1\geq1\)</span>, based on Bartlett’s decomposition.</p>
<div id="answer-3" class="section level3">
<h3>answer</h3>
<p>Choosing a matrix X based on Bartlett’s decomposition,. <span class="math inline">\(X^{T}*X\)</span> is a <span class="math inline">\(wd(\sum ,n)\)</span> (Wishart) distribution.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb11-2" title="2">d &lt;-<span class="dv">5</span></a>
<a class="sourceLine" id="cb11-3" title="3">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span>d<span class="op">^</span><span class="dv">2</span>, d, d)</a>
<a class="sourceLine" id="cb11-4" title="4">sigma &lt;-<span class="st"> </span><span class="kw">cov</span>(m)</a>
<a class="sourceLine" id="cb11-5" title="5">X &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(d, <span class="dt">mu=</span><span class="dv">1</span><span class="op">:</span>d, sigma)</a>
<a class="sourceLine" id="cb11-6" title="6">Y &lt;-<span class="st"> </span><span class="kw">t</span>(X)</a>
<a class="sourceLine" id="cb11-7" title="7">Z &lt;-<span class="st"> </span>Y<span class="op">%*%</span>X</a>
<a class="sourceLine" id="cb11-8" title="8">Z</a></code></pre></div>
<pre><code>##           [,1]     [,2]     [,3]      [,4]      [,5]
## [1,]  7.403645 12.53020 17.65675  22.78330  27.90985
## [2,] 12.530196 22.65675 32.78330  42.90985  53.03640
## [3,] 17.656746 32.78330 47.90985  63.03640  78.16295
## [4,] 22.783296 42.90985 63.03640  83.16295 103.28950
## [5,] 27.909847 53.03640 78.16295 103.28950 128.41605</code></pre>
<p>The matrix Z (produced by matrix X and Y) is the matrix which is required.</p>
</div>
</div>
</div>
<div id="section-2" class="section level1">
<h1>3</h1>
<div id="exercise-5.1" class="section level2">
<h2>Exercise 5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math inline">\(\int_{0}^{\pi /3}sintdt\)</span> and compare your estimate with the exact value of the integral.</p>
<div id="answer-4" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb13-2" title="2">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb13-3" title="3">x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-4" title="4">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>(pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-5" title="5"><span class="kw">print</span>(theta.hat)</a></code></pre></div>
<pre><code>## [1] 0.5014289</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">print</span>(<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)<span class="op">+</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<p>a Monte Carlo estimate of <span class="math inline">\(\int_{0}^{\pi /3}sintdt\)</span> is 0.5014289 and the estimate of the exact value of the integral is 0.5. Obviously, the Monte Carlo estimate value is approximate to the exact value.</p>
</div>
</div>
<div id="exercise-5.10" class="section level2">
<h2>Exercise 5.10</h2>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math inline">\(\int_{0}^{1}\frac{e^{-x}}{1+x^2}dx\)</span>, and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
<div id="answer-5" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb17-2" title="2">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb17-3" title="3">U &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#simple MC</span></a>
<a class="sourceLine" id="cb17-5" title="5">T1 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>U)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>U<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#MC with antithetic variables</span></a>
<a class="sourceLine" id="cb17-7" title="7">U1 &lt;-<span class="st"> </span><span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-8" title="8">U2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>U1</a>
<a class="sourceLine" id="cb17-9" title="9">T2 &lt;-<span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>U1)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>U1<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">exp</span>(<span class="op">-</span>U2)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>U2<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co">#print the variance of T1 and T2</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="kw">mean</span>(T1)</a></code></pre></div>
<pre><code>## [1] 0.52849</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">mean</span>(T2)</a></code></pre></div>
<pre><code>## [1] 0.5247481</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">var</span>(T1)</a></code></pre></div>
<pre><code>## [1] 0.06108799</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">var</span>(T2)</a></code></pre></div>
<pre><code>## [1] 0.00111977</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">(<span class="kw">var</span>(T1)<span class="op">-</span><span class="kw">var</span>(T2))<span class="op">/</span><span class="kw">var</span>(T1)</a></code></pre></div>
<pre><code>## [1] 0.9816696</code></pre>
<p>The approximate reduction in variance as a percentage 98%of the variance without variance reduction.</p>
</div>
</div>
<div id="exercise-5.15" class="section level2">
<h2>Exercise 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<div id="answer-6" class="section level3">
<h3>answer</h3>
<p>In Example5.10, our best result was obtained with importance function <span class="math inline">\(f_3(x)=\frac{e^{-x}}{1-e^{-1}}, 0&lt;x&lt;1\)</span>. From 10000 replicates we obtained the estimate <span class="math inline">\(\tilde{\theta }=0.5257801\)</span> and an estimated standard error 0.0970314. Now divide the interval (0,1) into five subintervals, <span class="math inline">\((\frac{j}{5},\frac{j+1}{5}), j=0,1,\cdots ,4\)</span>. Then on the <span class="math inline">\(j^{th}\)</span> subinterval variables are generated from the density <span class="math inline">\(\frac{5*e^{-x}}{1-e^{-1}}, \frac{j-1}{5}&lt;x&lt;\frac{j}{5}\)</span></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">M &lt;-<span class="st"> </span><span class="fl">1e5</span> </a>
<a class="sourceLine" id="cb27-2" title="2">k &lt;-<span class="st"> </span><span class="dv">5</span> </a>
<a class="sourceLine" id="cb27-3" title="3">N &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb27-4" title="4">T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb27-5" title="5">est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-6" title="6">g &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb27-7" title="7">  (<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-8" title="8">}</a>
<a class="sourceLine" id="cb27-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb27-10" title="10"><span class="co">#importance sampling estimate  </span></a>
<a class="sourceLine" id="cb27-11" title="11">  u&lt;-<span class="kw">runif</span>(M)</a>
<a class="sourceLine" id="cb27-12" title="12">  x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>u)</a>
<a class="sourceLine" id="cb27-13" title="13">  est[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(x))</a>
<a class="sourceLine" id="cb27-14" title="14">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb27-15" title="15"><span class="co">#stratified importance sampling estimate    </span></a>
<a class="sourceLine" id="cb27-16" title="16">    F1&lt;-(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>((<span class="dv">1</span><span class="op">-</span>j)<span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb27-17" title="17">    F2&lt;-(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb27-18" title="18">    u&lt;-<span class="st"> </span><span class="kw">runif</span>((F2<span class="op">-</span>F1)<span class="op">*</span>M)</a>
<a class="sourceLine" id="cb27-19" title="19">    x&lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>((F2<span class="op">-</span>F1)<span class="op">*</span>u<span class="op">+</span>F1))</a>
<a class="sourceLine" id="cb27-20" title="20">    T2[j]&lt;-<span class="kw">mean</span>((F2<span class="op">-</span>F1)<span class="op">*</span><span class="kw">g</span>(x))</a>
<a class="sourceLine" id="cb27-21" title="21">  }</a>
<a class="sourceLine" id="cb27-22" title="22">  est[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(T2)</a>
<a class="sourceLine" id="cb27-23" title="23">}</a>
<a class="sourceLine" id="cb27-24" title="24"><span class="co">#print the outcoming</span></a>
<a class="sourceLine" id="cb27-25" title="25"><span class="kw">apply</span>(est,<span class="dv">2</span>,mean)</a></code></pre></div>
<pre><code>## [1] 0.5247458 0.5247855</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">apply</span>(est,<span class="dv">2</span>,var)</a></code></pre></div>
<pre><code>## [1] 1.152734e-07 4.155050e-09</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">apply</span>(est,<span class="dv">2</span>,sd)</a></code></pre></div>
<pre><code>## [1] 3.395194e-04 6.445968e-05</code></pre>
<p>conclusion:<br />
1. The mean of importance sampling estimate and stratified importance sampling estimate is 0.5247458, 0.5247855.<br />
2. The variance of importance sampling estimate and stratified importance sampling estimate is 1.152734210^{-7}, 4.155050510^{-9}.<br />
3. The standard error of importance sampling estimate and stratified importance sampling estimate is 3.39519410^{-4}, 6.445968110^{-5}.<br />
4. It is easy to find that the variance of importance sampling estimate is bigger than stratified importance sampling estimate’s. Obviously, the stratified importance sampling estimate’s variance is reduced more, this method is a better choice.</p>
</div>
</div>
</div>
<div id="section-3" class="section level1">
<h1>4</h1>
<div id="exercise-6.5" class="section level2">
<h2>Exercise 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<div id="answer-7" class="section level3">
<h3>answer</h3>
<p>Example 6.4<br />
If <span class="math inline">\(X_1,\cdots, X_n\)</span> is a random sample from a Normal <span class="math inline">\((u,\sigma^2)\)</span> distribution, <span class="math inline">\(n\geqslant 2\)</span>, and <span class="math inline">\(S^2\)</span> is the sample variance, then <span class="math inline">\(V = \frac{(n-1)S^2}{\sigma^2}\sim \chi^2(n-1)\)</span><br />
A one side <span class="math inline">\(100(1-\alpha)%\)</span> confidence interval is given by <span class="math inline">\((0,\frac{(n-1)S^2}{\chi^2_\alpha})\)</span>, where <span class="math inline">\(\chi^2_\alpha\)</span> is the <span class="math inline">\(\alpha\)</span>-quantile of the <span class="math inline">\(\chi^2(n-1)\)</span> distribution. If the sampled population is normal with variance <span class="math inline">\(\sigma^2\)</span>, then the probability that the confidence interval contains <span class="math inline">\(\sigma^2\)</span> is <span class="math inline">\(1-\alpha\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co">#x is from a normal distribution </span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb33-3" title="3">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb33-4" title="4">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb33-5" title="5">UCL1 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb33-6" title="6">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb33-7" title="7">  (n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb33-8" title="8">})</a>
<a class="sourceLine" id="cb33-9" title="9"><span class="kw">sum</span>(UCL1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 949</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">mean</span>(UCL1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.949</code></pre>
<p>The result is that 949 intervals satisfied (UCL1 &gt; 4), so the empirical confidence level is 95% in this experiment. The result will vary but should be close to the theoretical value, 95%.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co">#x is from a chi-square data.</span></a>
<a class="sourceLine" id="cb37-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb37-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> </a>
<a class="sourceLine" id="cb37-4" title="4">UCL2 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> { </a>
<a class="sourceLine" id="cb37-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb37-6" title="6">  (n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>) </a>
<a class="sourceLine" id="cb37-7" title="7">})</a>
<a class="sourceLine" id="cb37-8" title="8"><span class="kw">sum</span>(UCL2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 799</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">mean</span>(UCL2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>) </a></code></pre></div>
<pre><code>## [1] 0.799</code></pre>
<p>The result is that 799 intervals satisfied (UCL2 &gt; 4), so the empirical confidence level is 80% in this experiment. The result will vary but should be close to the theoretical value, 80%.</p>
<p>In exercise 6.5</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb41-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb41-3" title="3">U1 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb41-4" title="4">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb41-5" title="5">  <span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">/</span>n)<span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb41-6" title="6">})</a>
<a class="sourceLine" id="cb41-7" title="7">U2 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb41-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb41-9" title="9">  <span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">/</span>n)<span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb41-10" title="10">})</a>
<a class="sourceLine" id="cb41-11" title="11"><span class="kw">mean</span>(U1 <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>U2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.916</code></pre>
<p>The coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20 is 92%, it is very approximate to 95%.</p>
<p>discuss: if x is from normal distribution, how about the coverage probablity?</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb43-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb43-3" title="3">U3 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb43-4" title="4">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span> )</a>
<a class="sourceLine" id="cb43-5" title="5">  <span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">/</span>n)<span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb43-6" title="6">})</a>
<a class="sourceLine" id="cb43-7" title="7">U4 &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb43-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span> )</a>
<a class="sourceLine" id="cb43-9" title="9">  <span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">/</span>n)<span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb43-10" title="10">})</a>
<a class="sourceLine" id="cb43-11" title="11"><span class="kw">mean</span>(U3 <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>U4 <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 0.962</code></pre>
<p>The coverage probability is 96%, the result is very well.</p>
</div>
</div>
<div id="exercise-6.6" class="section level2">
<h2>Exercise 6.6</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_1}\approx N(0,6/n)\)</span></p>
<div id="answer-8" class="section level3">
<h3>answer</h3>
<p>2.14 <span class="math inline">\(Var(\hat{x_q})=\frac{q(1-q)}{nf(x_q)^2}\)</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co">#Estimate the quantiles of the skewness under normality by a Monte Carlo experiment</span></a>
<a class="sourceLine" id="cb45-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb45-3" title="3">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb45-4" title="4">sk &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb45-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb45-6" title="6">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb45-7" title="7">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb45-8" title="8">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb45-9" title="9">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb45-10" title="10">  sk[i] &lt;-<span class="st"> </span>m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span>  </a>
<a class="sourceLine" id="cb45-11" title="11">}</a>
<a class="sourceLine" id="cb45-12" title="12">y1 &lt;-<span class="st"> </span><span class="kw">unname</span>(<span class="kw">quantile</span>(sk,<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)))</a>
<a class="sourceLine" id="cb45-13" title="13">y1</a></code></pre></div>
<pre><code>## [1] -0.1512145 -0.1284523  0.1278482  0.1527684</code></pre>
<p>The quantiles of the skewness under normality by a Monte Carlo experiment is -0.1512145, -0.1284523, 0.1278482, 0.1527684</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co">#Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula)</span></a>
<a class="sourceLine" id="cb47-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb47-3" title="3">q &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb47-4" title="4">f &lt;-<span class="st"> </span><span class="kw">qnorm</span>(q, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb47-5" title="5">sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q)<span class="op">/</span>(n<span class="op">*</span>f<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb47-6" title="6">sd</a></code></pre></div>
<pre><code>## [1] 0.03261751 0.05425580 0.05425580 0.03261751</code></pre>
<p>The standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula) is 0.0326175, 0.0542558, 0.0542558, 0.0326175</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co">#estimated quantiles with the quantiles of the large sample approximation N(0,6/n)</span></a>
<a class="sourceLine" id="cb49-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb49-3" title="3">y2 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb49-4" title="4">y2</a></code></pre></div>
<pre><code>## [1] -0.1518182 -0.1274098  0.1274098  0.1518182</code></pre>
<p>The quantiles with the quantiles of the large sample approximation N(0,6/n) is -0.1518182, -0.1274098, 0.1274098, 0.1518182</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co">#compare the quantiles</span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="kw">data.frame</span>(<span class="dt">quantiles =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>), <span class="dt">q_MC_est =</span> y1, <span class="dt">q_sample_approximation =</span> y2, sd)</a></code></pre></div>
<pre><code>##   quantiles   q_MC_est q_sample_approximation         sd
## 1     0.025 -0.1512145             -0.1518182 0.03261751
## 2     0.050 -0.1284523             -0.1274098 0.05425580
## 3     0.950  0.1278482              0.1274098 0.05425580
## 4     0.975  0.1527684              0.1518182 0.03261751</code></pre>
<p>From the table, we can find the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_1}\approx N(0,6/n)\)</span> are almost same.</p>
</div>
</div>
</div>
<div id="section-4" class="section level1">
<h1>5</h1>
<div id="exercise-6.7" class="section level2">
<h2>Exercise 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(v)\)</span>?</p>
<div id="answer-9" class="section level3">
<h3>answer</h3>
<p>symmetric Beta distribution</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">alpha &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb53-2" title="2">n &lt;-<span class="st"> </span><span class="dv">100</span> </a>
<a class="sourceLine" id="cb53-3" title="3">m &lt;-<span class="st"> </span><span class="dv">2500</span> </a>
<a class="sourceLine" id="cb53-4" title="4">epsilon &lt;-<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">30</span>) </a>
<a class="sourceLine" id="cb53-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon) </a>
<a class="sourceLine" id="cb53-6" title="6">power &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) </a>
<a class="sourceLine" id="cb53-7" title="7"></a>
<a class="sourceLine" id="cb53-8" title="8"><span class="co">#computes the sample skewness coeff. </span></a>
<a class="sourceLine" id="cb53-9" title="9">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) { </a>
<a class="sourceLine" id="cb53-10" title="10">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb53-11" title="11">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb53-12" title="12">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb53-13" title="13">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> ) </a>
<a class="sourceLine" id="cb53-14" title="14">  }</a>
<a class="sourceLine" id="cb53-15" title="15"></a>
<a class="sourceLine" id="cb53-16" title="16"><span class="co">#critical value for the skewness test </span></a>
<a class="sourceLine" id="cb53-17" title="17">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb53-18" title="18"></a>
<a class="sourceLine" id="cb53-19" title="19"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </a>
<a class="sourceLine" id="cb53-20" title="20">  <span class="co">#for each epsilon </span></a>
<a class="sourceLine" id="cb53-21" title="21">  e &lt;-<span class="st"> </span>epsilon[j] </a>
<a class="sourceLine" id="cb53-22" title="22">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb53-23" title="23">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb53-24" title="24">    <span class="co">#for each replicate   </span></a>
<a class="sourceLine" id="cb53-25" title="25">    Y &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e)) </a>
<a class="sourceLine" id="cb53-26" title="26">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, alpha, alpha) <span class="op">*</span><span class="st"> </span>(Y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rbeta</span>(n, alpha, <span class="dv">100</span><span class="op">*</span>alpha) <span class="op">*</span><span class="st"> </span>(Y <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb53-27" title="27">    sktests[i] &lt;-<span class="st"> </span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb53-28" title="28">  }</a>
<a class="sourceLine" id="cb53-29" title="29">  power[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) </a>
<a class="sourceLine" id="cb53-30" title="30">} </a>
<a class="sourceLine" id="cb53-31" title="31"></a>
<a class="sourceLine" id="cb53-32" title="32"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb53-33" title="33"><span class="kw">plot</span>(epsilon, power, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb53-34" title="34"><span class="co">#abline(h = .1, lty = 3)</span></a>
<a class="sourceLine" id="cb53-35" title="35">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>power) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb53-36" title="36"><span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb53-37" title="37"><span class="kw">lines</span>(epsilon, power<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb53-38" title="38"><span class="kw">lines</span>(epsilon, power<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>By considering the figure, the power is increasing when epsilon is increasing, and when epsilon approximately equals to 0.5, power is already approximately equals to 1.</p>
<p>heavy-tailed symmetric alternatives such as t(v)</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">alpha &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb54-2" title="2">n &lt;-<span class="st"> </span><span class="dv">100</span> </a>
<a class="sourceLine" id="cb54-3" title="3">m &lt;-<span class="st"> </span><span class="dv">2500</span> </a>
<a class="sourceLine" id="cb54-4" title="4">epsilon &lt;-<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span> ,<span class="dt">length.out =</span> <span class="dv">30</span>) </a>
<a class="sourceLine" id="cb54-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon) </a>
<a class="sourceLine" id="cb54-6" title="6">power &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) </a>
<a class="sourceLine" id="cb54-7" title="7"></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="co">#computes the sample skewness coeff. </span></a>
<a class="sourceLine" id="cb54-9" title="9">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) { </a>
<a class="sourceLine" id="cb54-10" title="10">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb54-11" title="11">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb54-12" title="12">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb54-13" title="13">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> ) </a>
<a class="sourceLine" id="cb54-14" title="14">}</a>
<a class="sourceLine" id="cb54-15" title="15"></a>
<a class="sourceLine" id="cb54-16" title="16"><span class="co">#critical value for the skewness test </span></a>
<a class="sourceLine" id="cb54-17" title="17">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb54-18" title="18"></a>
<a class="sourceLine" id="cb54-19" title="19"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </a>
<a class="sourceLine" id="cb54-20" title="20">  <span class="co">#for each epsilon </span></a>
<a class="sourceLine" id="cb54-21" title="21">  e &lt;-<span class="st"> </span>epsilon[j] </a>
<a class="sourceLine" id="cb54-22" title="22">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb54-23" title="23">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb54-24" title="24">    <span class="co">#for each replicate   </span></a>
<a class="sourceLine" id="cb54-25" title="25">    Y &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e)) </a>
<a class="sourceLine" id="cb54-26" title="26">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, alpha, alpha) <span class="op">*</span><span class="st"> </span>(Y <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rt</span>(n, <span class="dv">100</span><span class="op">*</span>alpha) <span class="op">*</span><span class="st"> </span>(Y <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb54-27" title="27">    sktests[i] &lt;-<span class="st"> </span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb54-28" title="28">  }</a>
<a class="sourceLine" id="cb54-29" title="29">  power[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) </a>
<a class="sourceLine" id="cb54-30" title="30">} </a>
<a class="sourceLine" id="cb54-31" title="31"></a>
<a class="sourceLine" id="cb54-32" title="32"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb54-33" title="33"><span class="kw">plot</span>(epsilon, power, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb54-34" title="34"><span class="co">#abline(h = .1, lty = 3)</span></a>
<a class="sourceLine" id="cb54-35" title="35">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(power <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>power) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb54-36" title="36"><span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb54-37" title="37"><span class="kw">lines</span>(epsilon, power<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb54-38" title="38"><span class="kw">lines</span>(epsilon, power<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The empirical power curve is shown in Figure. Note that the power curve crosses the horizontal line corresponding to <span class="math inline">\(\alpha=0.05\)</span> at both endpoints, <span class="math inline">\(\epsilon=0\)</span> and <span class="math inline">\(\epsilon=1\)</span> where the alternative is normally distributed. For <span class="math inline">\(0&lt;\epsilon&lt;1\)</span> the empirical power of the test is greater than 0.05 and highest when <span class="math inline">\(\epsilon\)</span> is about 0.10.</p>
<p>conclusion：After estimating the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions, it comes to a conclusion that the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(v)\)</span>.</p>
</div>
</div>
<div id="exercise-6.a" class="section level2">
<h2>Exercise 6.A</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is<br />
(i) <span class="math inline">\(\chi ^{2}(1)\)</span><br />
(ii) Uniform(0,2)<br />
(iii) Exponential(rate=1) In each case, test <span class="math inline">\(H_{0} : \mu=\mu_{0}\)</span> vs <span class="math inline">\(H_{0} : \mu\neq\mu_{0}\)</span>, where <span class="math inline">\(\mu_{0}\)</span> is the mean of <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
<div id="answer-10" class="section level3">
<h3>answer</h3>
<p>Case(i): chisq(1)</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb55-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb55-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#null hypothesis</span></a>
<a class="sourceLine" id="cb55-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates </span></a>
<a class="sourceLine" id="cb55-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb55-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb55-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, mu0) </a>
<a class="sourceLine" id="cb55-8" title="8">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb55-9" title="9">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value </a>
<a class="sourceLine" id="cb55-10" title="10">  }</a>
<a class="sourceLine" id="cb55-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha) </a>
<a class="sourceLine" id="cb55-12" title="12">p.hat</a></code></pre></div>
<pre><code>## [1] 0.1052</code></pre>
<p>By the Monte Carlo simulation, the empirical Type I error rate of the t-test for the cases where the sampled population is <span class="math inline">\(\chi^{2}(1)\)</span>, is much bigger than the nominal significance level <span class="math inline">\(\alpha\)</span>.</p>
<p>Case(ii): Uniform(0,2)</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb57-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> </a>
<a class="sourceLine" id="cb57-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co">#null hypothesis</span></a>
<a class="sourceLine" id="cb57-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates </span></a>
<a class="sourceLine" id="cb57-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb57-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb57-8" title="8">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb57-9" title="9">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value </a>
<a class="sourceLine" id="cb57-10" title="10">  }</a>
<a class="sourceLine" id="cb57-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha) </a>
<a class="sourceLine" id="cb57-12" title="12">p.hat</a></code></pre></div>
<pre><code>## [1] 0.053</code></pre>
<p>By the Monte Carlo simulation, the empirical Type I error rate of the t-test for the cases where the sampled population is Uniform(0,2), is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>.</p>
<p>Case(iii): Exponential(rate=1)</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb59-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span> </a>
<a class="sourceLine" id="cb59-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co">#null hypothesis</span></a>
<a class="sourceLine" id="cb59-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates </span></a>
<a class="sourceLine" id="cb59-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb59-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb59-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb59-8" title="8">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb59-9" title="9">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value </a>
<a class="sourceLine" id="cb59-10" title="10">  }</a>
<a class="sourceLine" id="cb59-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha) </a>
<a class="sourceLine" id="cb59-12" title="12">p.hat</a></code></pre></div>
<pre><code>## [1] 0.0817</code></pre>
<p>By the Monte Carlo simulation, the empirical Type I error rate of the t-test for the cases where the sampled population is Exponential(rate=1), is little bigger than the nominal significance level <span class="math inline">\(\alpha\)</span>.</p>
</div>
</div>
<div id="exercise3-discussion" class="section level2">
<h2>Exercise3: Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: says, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level? 1. What is the corresponding hypothesis test problem? 2. What test should we use? Z-test, two-sample t-test, paired-t-test or McNemar test? 3. What information is needed to test your hypothesis?</p>
<div id="answer-11" class="section level3">
<h3>answer</h3>
<ol style="list-style-type: decimal">
<li><p>Let <span class="math inline">\(P_1\)</span> denote the power for one method, and <span class="math inline">\(P_2\)</span> for another method.Let <span class="math inline">\(T_1\)</span> denote the testing statistic for one method, and <span class="math inline">\(T_2\)</span> for another method.Let <span class="math inline">\(W_1\)</span> denote the rejection area for one method, and <span class="math inline">\(W_2\)</span> for another method. The significant level is <span class="math inline">\(\alpha=0.05\)</span>.Then the test hypotheses are <span class="math inline">\(H0 : P1 = P2\)</span> vs <span class="math inline">\(H1 : P1 \neq P2\)</span>. If H0 is false, we can say the powers are different at 0.05 level, otherwise, we can’t say the powers are different at 0.05 level.</p></li>
<li><p>Firstly, these four methods will be introduced shortly:<br />
</p></li>
</ol>
<ul>
<li><p>Z-test: A Z-test is any statistical test for which the distribution of the test statistic under the null hypothesis can be approximated by a normal distribution. Because of the central limit theorem, many test statistics are approximately normally distributed for large samples. For each significance level, the Z-test has a single critical value (for example, 1.96 for 5% two tailed) which makes it more convenient than the Student’s t-test which has separate critical values for each sample size. Therefore, many statistical tests can be conveniently performed as approximate Z-tests if the sample size is large or the population variance is known. If the population variance is unknown (and therefore has to be estimated from the sample itself) and the sample size is not large (n &lt; 30), the Student’s t-test may be more appropriate.</p></li>
<li><p>two sample t-test: In statistics, “two sample t-test” is also named “Welch’s t-test”, or “unequal variances t-test”, is a two-sample location test which is used to test the hypothesis that two populations have equal means. It is named for its creator, Bernard Lewis Welch, and is an adaptation of Student’s t-test, and is more reliable when the two samples have unequal variances and/or unequal sample sizes. These tests are often referred to as “unpaired” or “independent samples” t-tests, as they are typically applied when the statistical units underlying the two samples being compared are non-overlapping. Given that Welch’s t-test has been less popular than Student’s t-test and may be less familiar to readers, a more informative name is “Welch’s unequal variances t-test” — or “unequal variances t-test” for brevity.</p></li>
<li><p>paired sample t-test: In statistic, paired sample t-test is used to compare two means that are repeated measures for the same participants - scores might be repeated across different measures or across time. It is also used also to compare paired samples, as in a two treatment randomized block design.</p></li>
<li><p>MCNemar test: McNemar’s test is a statistical test used on paired nominal data. It is applied to 2 × 2 contingency tables with a dichotomous trait, with matched pairs of subjects, to determine whether the row and column marginal frequencies are equal (that is, whether there is “marginal homogeneity”). It is named after Quinn McNemar, who introduced it in 1947. An application of the test in genetics is the transmission disequilibrium test for detecting linkage disequilibrium. The commonly used parameters to assess a diagnostic test in medical sciences are sensitivity and specificity. Sensitivity is the ability of a test to correctly identify the people with disease. Specificity is the ability of the test to correctly identify those without the disease. Now presume two tests are performed on the same group of patients. And also presume that these tests have identical sensitivity and specificity. In this situation one is carried away by these findings and presume that both the tests are equivalent. However this may not be the case. For this we have to study the patients with disease and patients without disease (by a reference test). We also have to find out where these two tests disagree with each other. This is precisely the basis of McNemar’s test. This test compares the sensitivity and specificity of two diagnostic tests on the same group of patients.</p></li>
</ul>
<p>After learning four methods, as for this problem, the best chance is “MCNemar test”. Because we have two samples and these two samples are not independent.</p>
<ol start="3" style="list-style-type: decimal">
<li>The information what we need is: the rejection area <span class="math inline">\(W_1\)</span>, <span class="math inline">\(W_2\)</span>, the testing statistic <span class="math inline">\(T_1\)</span>, <span class="math inline">\(T_2\)</span>.</li>
</ol>
</div>
</div>
</div>
<div id="section-5" class="section level1">
<h1>6</h1>
<div id="exercise-7.6" class="section level2">
<h2>Exercise 7.6</h2>
<p>Efronand Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\((x_{i1},\cdots,x_{i5})\)</span> for the <span class="math inline">\(i^{th}\)</span> student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat{\rho }_{12}=\hat{\rho}(mec, vec)\)</span>, <span class="math inline">\(\hat{\rho }_{34}=\hat{\rho}(alg,ana)\)</span>, <span class="math inline">\(\hat{\rho }_{35}=\hat{\rho}(alg, sta)\)</span>, <span class="math inline">\(\hat{\rho }_{45}=\hat{\rho}(ana, sta)\)</span>.</p>
<div id="answer-12" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb61-2" title="2"><span class="co">#par(mfrow = c(2, 2))</span></a>
<a class="sourceLine" id="cb61-3" title="3"><span class="kw">plot</span>(scor<span class="op">$</span>mec, scor<span class="op">$</span>vec)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">plot</span>(scor<span class="op">$</span>alg, scor<span class="op">$</span>ana)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OpA6ZmY6kNtmAABmADpmOpBmtv+QOgCQZgCQkGaQ2/+2ZgC2tma225C2/7a2///bkDrb25Db2//b/7bb////tmb/25D//7b//9v///8Cq3ANAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALhUlEQVR4nO2djXbjKBKF6bQzu9vpTu9EO9OamdiO3v8lV4BA6PcCKmQ5vvecdjtOGdAXqCoQklRDrUrdugFHFwEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQUBqgj5/K6OlXoeYcT0mAavXNvjm7N59fKYA+fnos9df3Ao05olIAXV9e3dvzwwwy4R6k7kYlALU+qOtCiz7oZkHRHHLMcXc2ZQC1g8ziX/RAtwKk6zVHjhqggn/RJQvqRoBsp4joGsq97gwofWjL6iCAri8wuD86oP88gwTxAD5ovRsX9UHXl29tIDtJFScqH8XQ0ZeMYhqQDvErjG4+91X962pXKgioMYwWMukDAVrvSmUByRQnLx9G1aArzZpGl5lQ/9EBDbJFMMoeLFEM6laBF1aNWmrR4wDqM9TRoHJ05pv0MICUy3zUxOusBvRPBsg734FPCSY4npAKrVea9LkAqdE/96nrPB2gjkxvtRLpPxUgd7S9F/ZjynYfB2hg3dlubejdAbJAnAtWgQ8aWQs19N4AOTyu20zXWR4L0NCruDHV+C407Dx9G2A7dgZUasFsEpc8nbD7zLQmquToJghKtrjJaPGja3NFnwxQmCyPXU5ev80A5M5YbDolWAaQ7zVTB6zWJlyw6CTD6ut7fWouz68r1nL1LpeghkOq8VmgDWE28ekivl9BTK43HZBeyzh/fd941n0zoFEIGnnlfnypgN5egF6by79+mX/5kvGd07jde+fxq3Ir0WmuKB2QPvF+/f52OEDKjyqXNSufDjWBD4rKfjIa2hvWrXeuvt14iM0GdjeyVLdeqPre1IS/SKk+J8xXJx3JVoMY3GEm7oO87zE/DVbHBh1pD0BYeIeZcBRbAqRcQuT73CEAxewPSiguRsPoNeouPZRdfBDeoBmxw0wC0DgT8oFq4IP6tLHPilIqSTesYAq9Tw+aZkI+OXRv+/wou8q8RBFpjx1mM0ftvdD4NMV4WCV0orxEEWqHHWYA0MiHjz16dANyEsXVbRvS9YISxoD6hHB6hkMNQlhkCzK62lnlT1MH4XejZvqBC+oq+LU3G7wpCMiNntUo1m1/kU8UQ7T9e488+Kh79TQGsT6+BUXyIAPIxK9Fh5UJaL7zDdZ6fAbtwllXXYClrA+KkAbUoZEN8y69GZcVpDsOVp8JBQlin08XjGIRK4oaULegJpsozjlmFeaD3v8oz1L16HKqzUkU4YpiuR40+W7fd3zXabpgH0zFOtt91qQjVhRtHzs1K1llUrYfOGP3MigmYNMvtnr7bSlFXqKIVxRbRl/eVi4XS2h0ODQGTjqYlPYT9uHCWN6wympokCjuu6I4HFYhn+kvO4twGrY148rwQTuvKC5lLeO8ZvhTOAw3McoJdxErinL1IkCTOdfYfuMoK5IHyRa3cISz4PqYv2qWoDsAtDRGZsAFOVDWzHShliTDSrueuq1+04lVEd4TcHOzib0B1W3wbs7ty81PPS8WOvLU+/qg68vJrQhVtz31vFzoOJTtGsUqFWrDTQPkAQ3889aBFRSbZmimDnqEZfYgyQWzccHeP5ufG6E/QqoPqp5+2RG28aYT0kHRzi3E0sOgnFTDyq7E1xtvyiELKHtzS0zR0oa3KO5QgIKzgnvUG1GUm8mLOzZTerJh1HkxuXqjShKZty8Xn2gockOXtINZOfjZOasgrZweBE/7SNbrjEdz9lFBs3MyEd2Dk15dwJgDJJcmFgMkusNsdLzDH/1a6/IXNikH0OW5bZXJppcku8NsDdCsd74xIHvQ9cp6h/T+oKFLma7zTCjd1Ae5o1897SO8w2zx8B2gNTe+Tfl50Eq0L73DbLJFQXJMjetKNozoQTvew8yf5BEsc1hBuiH2QTvew+yIgCKimGC9McVkXIKRWIOk4XopQgtmk3MW4wUzMZUEdFbL/Wzbcfig1QMafi6nHEB6sRUsKFZKfbv8+118h1kTzEs9oR5XAE1KGYDsYrQ5v7EkbVKZ3iMe5vtO4ufx/odjAIrIg4zJ5be3Favco1gEYcAJbHeZrTDJ0OdBaJfrx9+NfA9a9jXKX6YhSihjiNkM6LJ2p0QPT2SH2fR7s2GwTB8qlAfV9tfLe84FfNBskeJuaOc8SKC4xSFEQP2XZ7fbTwKciDIA2RuRLk+zZOsdf08N3cxgxE23T21XXh50eT7pjXh71Dv+2vCedTMd5uZRTCc52vluO/uTdxD9zaRmAZWYr+YB0ldlruRBkvWOvrUGqMBMLG+InfQNtVenGpHFJf/Fw4sO+nICPvKEspx0mwRtve5wMMlM+do4WZ4sv25q1lyN0obRxWUd0Mpa0qcAFC6YFUlZjuCDpOqV/4sfI4rJ1SvyFy+0FN2XL26YUJzAwRUZVuMKZA13La6MY57WIGm4a3HB8tDnOO0jXVzfg0qNtTsHFLApROjeAQUXgkuWGpQvbmhU/h5mo7LuDNAe9zAbFXZXPmj3e5jdWxTb6R5mu+hz9KCCKuWDDvuUzFQVimJZO8xKzzuzdKA8qPi8M0s3XDCbreBwhI7TgwgIFPdIgPwVU8uTjQf3QR8/0VnFR49i8LTZAVHMq5QPQrfrVHejQoAytFTD0T6XMc/Q0UAQUObnMuYZOhoIAsr8XMY8Q0cDQUCZn8uYZ+hoIAgo83MZ88cTAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERBQOUBmw6fZRrR2u5ih7P1DIu31df6nhPL9Hfvj29MUBPTxs21ErY9A38j7HNWis9l4FGmvH0Rkro+MtK/NM3deU9qjVQyQfXpArW/krbtRzMXU1xcNKNLemsWX392x/xRbvlNhH9T+pTwpaFx//W8LKNLe3oWmaWLtPaD49hgVBlQ9/Vq/n06g1lD7oEj789OfL8bHxZbvhlh0e6zKAtKbPe1wx4Ned31zE6w4+1rvwNHdIrZ855uj7a2KAjo7Hx3TIL2zOAXQl64jxJavbwqgb/5zIEB2s3BklzZmCUPMOpHWocSW71zPcYZYd2VHpFOsu20pr5H29gjbo421dx3nME7a7TpPCatVfJi310Wco8O85RJv71QwD3Kb8RMSsyohUawdzEh754OOkih2Q0Y3pFZpU41I+7ObykTaV4n2VpysAhEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQ0J0Auv7Y9ESdDboPQP60eqfFZyzK6y4AVU9//vjrOWBCQANdnl/bIVYFN298PEDm6Xhm55ey2+e7vS3X77+rpz8MIGNXWTMDqH3/5feNTxbGOgYgs/1L79HVWzP1g870e72NXj9uSL/8YwHpfWHWxD6p6bz10ctYxwDktlS6h0vabXLnL2/2A3dVxvX7m4XZArJb6qoHAXR9sYQunSe2/2vf0zmb64sLY2dlOterZRq/lS5XxwBkLw169dcXWEAtBg+oddL64WfKeCT9m/qxAGlVbovuXA/68e52/HZD7MF6kJbpMBMfZK9fagG1rwaK9d9uO/WDADq7iyj0AZsLMHwUM0G9jWL/vJy6ztM6o4eLYibtsY8hH+VBZogZD3Vqug28Vdex2jzo6X+bnsgYo4MAQlqarG57pmeM7gTQVMYHLT6UW053C8gMQnBnWQndL6CdREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAT0f1CrUBcadfkIAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">plot</span>(scor<span class="op">$</span>alg, scor<span class="op">$</span>sta)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">plot</span>(scor<span class="op">$</span>ana, scor<span class="op">$</span>sta)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co">#get the sample correlation matrix</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">cor</span>(scor)</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="co">#Obtain bootstrap estimates of the standard errors</span></a>
<a class="sourceLine" id="cb67-2" title="2"><span class="co">#set up the bootstrap </span></a>
<a class="sourceLine" id="cb67-3" title="3">B &lt;-<span class="st"> </span><span class="dv">200</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb67-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor) <span class="co">#sample size</span></a>
<a class="sourceLine" id="cb67-5" title="5">R12 &lt;-<span class="st"> </span>R34 &lt;-<span class="st"> </span>R35 &lt;-<span class="st"> </span>R45 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) <span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb67-6" title="6"></a>
<a class="sourceLine" id="cb67-7" title="7"><span class="co">#bootstrap estimate of standard error of R </span></a>
<a class="sourceLine" id="cb67-8" title="8"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { </a>
<a class="sourceLine" id="cb67-9" title="9">  <span class="co">#randomly select the indices </span></a>
<a class="sourceLine" id="cb67-10" title="10">  i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb67-11" title="11">  mec &lt;-<span class="st"> </span>scor<span class="op">$</span>mec[i] <span class="co">#i is a vector of indices </span></a>
<a class="sourceLine" id="cb67-12" title="12">  vec &lt;-<span class="st"> </span>scor<span class="op">$</span>vec[i]</a>
<a class="sourceLine" id="cb67-13" title="13">  alg &lt;-<span class="st"> </span>scor<span class="op">$</span>alg[i]</a>
<a class="sourceLine" id="cb67-14" title="14">  ana &lt;-<span class="st"> </span>scor<span class="op">$</span>ana[i]</a>
<a class="sourceLine" id="cb67-15" title="15">  sta &lt;-<span class="st"> </span>scor<span class="op">$</span>sta[i]</a>
<a class="sourceLine" id="cb67-16" title="16">  R12[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(mec, vec)</a>
<a class="sourceLine" id="cb67-17" title="17">  R34[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(alg, ana)</a>
<a class="sourceLine" id="cb67-18" title="18">  R35[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(alg, sta)</a>
<a class="sourceLine" id="cb67-19" title="19">  R45[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(ana, sta)</a>
<a class="sourceLine" id="cb67-20" title="20">}</a>
<a class="sourceLine" id="cb67-21" title="21"><span class="co"># to compute standard error by using the bootstrap estimate.</span></a>
<a class="sourceLine" id="cb67-22" title="22">se.R12 &lt;-<span class="st"> </span><span class="kw">sd</span>(R12)</a>
<a class="sourceLine" id="cb67-23" title="23">se.R34 &lt;-<span class="st"> </span><span class="kw">sd</span>(R34)</a>
<a class="sourceLine" id="cb67-24" title="24">se.R35 &lt;-<span class="st"> </span><span class="kw">sd</span>(R35)</a>
<a class="sourceLine" id="cb67-25" title="25">se.R45 &lt;-<span class="st"> </span><span class="kw">sd</span>(R45)</a>
<a class="sourceLine" id="cb67-26" title="26"><span class="co"># draw a table to present the result.</span></a>
<a class="sourceLine" id="cb67-27" title="27">p &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(se.R12, se.R34, se.R35, se.R45), <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb67-28" title="28"><span class="kw">colnames</span>(p) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Rho_12&quot;</span>,<span class="st">&quot;Rho_34&quot;</span>,<span class="st">&quot;Rho_35&quot;</span>,<span class="st">&quot;Rho_45&quot;</span>)</a>
<a class="sourceLine" id="cb67-29" title="29"><span class="kw">rownames</span>(p) &lt;-<span class="st"> &quot;Standard Errors&quot;</span></a>
<a class="sourceLine" id="cb67-30" title="30">knitr<span class="op">::</span><span class="kw">kable</span>(p)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Rho_12</th>
<th align="right">Rho_34</th>
<th align="right">Rho_35</th>
<th align="right">Rho_45</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Standard Errors</td>
<td align="right">0.0794734</td>
<td align="right">0.0472556</td>
<td align="right">0.0610451</td>
<td align="right">0.0753461</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="project-7.b" class="section level2">
<h2>Project 7.B</h2>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness).</p>
<div id="answer-13" class="section level3">
<h3>answer</h3>
<p>Project 7.A Conduct a Monte Carlo study to estimate the coverage probabilities of the standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval. Sample from a normal population and check the empirical coverage rates for the sample mean. Find the proportion of times that the confidence intervals miss on the left, and the porportion of times that the confidence intervals miss on the right.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">library</span>(boot)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lattice&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb71-2" title="2">m &lt;-<span class="st"> </span><span class="fl">1e3</span></a>
<a class="sourceLine" id="cb71-3" title="3">B &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb71-4" title="4">ci.norm &lt;-<span class="st"> </span>ci.basic &lt;-<span class="st"> </span>ci.perc &lt;-<span class="st"> </span>ci.bca &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb71-5" title="5"></a>
<a class="sourceLine" id="cb71-6" title="6"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb71-7" title="7">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) { </a>
<a class="sourceLine" id="cb71-8" title="8">  x&lt;-x[i]</a>
<a class="sourceLine" id="cb71-9" title="9">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb71-10" title="10">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb71-11" title="11">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb71-12" title="12">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> ) </a>
<a class="sourceLine" id="cb71-13" title="13">}</a></code></pre></div>
<p>the normal populations (skewness 0) distributions</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">sk.norm =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </a>
<a class="sourceLine" id="cb72-3" title="3">  U &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb72-4" title="4">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> U, <span class="dt">statistic =</span> sk, B) </a>
<a class="sourceLine" id="cb72-5" title="5">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>)) </a>
<a class="sourceLine" id="cb72-6" title="6">  ci.norm[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb72-7" title="7">  ci.basic[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>] </a>
<a class="sourceLine" id="cb72-8" title="8">  ci.perc[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb72-9" title="9">  } </a>
<a class="sourceLine" id="cb72-10" title="10"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>, <span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>sk.norm <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>sk.norm), <span class="st">&#39;basic =&#39;</span>, <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>sk.norm <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>sk.norm), <span class="st">&#39;perc =&#39;</span>, <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>sk.norm <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>sk.norm))</a></code></pre></div>
<pre><code>## norm = 0.881 basic = 0.873 perc = 0.998</code></pre>
<p>The coverage rates for normal populations of the standard normal bootstrap confidence interval is 0.881;<br />
The coverage rates for normal populations of the basic bootstrap confidence interval is 0.873;<br />
The coverage rates for normal populations of the percentile confidence interval is 0.998.</p>
<p>the chisq distributions (positive skewness)</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">sk.chisq =<span class="st"> </span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </a>
<a class="sourceLine" id="cb74-3" title="3">  U &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb74-4" title="4">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> U, <span class="dt">statistic =</span> sk, B) </a>
<a class="sourceLine" id="cb74-5" title="5">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>)) </a>
<a class="sourceLine" id="cb74-6" title="6">  ci.norm[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb74-7" title="7">  ci.basic[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>] </a>
<a class="sourceLine" id="cb74-8" title="8">  ci.perc[i,] &lt;-<span class="st"> </span>ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb74-9" title="9">  } </a>
<a class="sourceLine" id="cb74-10" title="10"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>, <span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>sk.chisq <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>sk.chisq), <span class="st">&#39;basic =&#39;</span>, <span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>sk.chisq <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>sk.chisq), <span class="st">&#39;perc =&#39;</span>, <span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>] <span class="op">&lt;=</span><span class="st"> </span>sk.chisq <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>] <span class="op">&gt;=</span><span class="st"> </span>sk.chisq))</a></code></pre></div>
<pre><code>## norm = 0.76 basic = 0.733 perc = 0.735</code></pre>
<p>The coverage rates for <span class="math inline">\(\chi^2(5)\)</span> distribution of the standard normal bootstrap confidence interval is 0.76;<br />
The coverage rates for <span class="math inline">\(\chi^2(5)\)</span> distribution of the basic bootstrap confidence interval is 0.733;<br />
The coverage rates for <span class="math inline">\(\chi^2(5)\)</span> distribution of the percentile confidence interval is 0.735.</p>
</div>
</div>
</div>
<div id="section-6" class="section level1">
<h1>7</h1>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jacknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
<div id="answer-14" class="section level3">
<h3>answer</h3>
<p>Exercise 7.7 Refer to Exercise 7.6. Efron and Tibshirani discuss the following example [84, Ch. 7]. The five-dimensional scores data have a <span class="math inline">\(5 \times 5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\cdots&gt;\lambda_5\)</span>. In principal components analysis, <span class="math inline">\(\theta =\frac{\lambda _1}{\sum_{j=1}^{5}\lambda _j}\)</span> measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat{\lambda_1}&gt;\cdots&gt;\hat{\lambda_5}\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math inline">\(\hat{\theta}=\frac{\hat{\lambda _1}}{\sum_{j=1}^{5}\hat{\lambda_j}}\)</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="co"># To obtain the parameter theta</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb76-3" title="3"><span class="kw">library</span>(boot) <span class="co">#for boot function</span></a>
<a class="sourceLine" id="cb76-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb76-5" title="5">theta.hat &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb76-6" title="6">  y &lt;-<span class="st"> </span><span class="kw">cov</span>(x)</a>
<a class="sourceLine" id="cb76-7" title="7">  lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(y)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb76-8" title="8">  theta &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(lambda)</a>
<a class="sourceLine" id="cb76-9" title="9">}</a></code></pre></div>
<p>Via bootstrap in Exercise 7.7</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb77-2" title="2"><span class="co">#set up the bootstrap</span></a>
<a class="sourceLine" id="cb77-3" title="3">B &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb77-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb77-5" title="5">theta.boot &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb77-6" title="6"></a>
<a class="sourceLine" id="cb77-7" title="7"><span class="co">#bootstrap</span></a>
<a class="sourceLine" id="cb77-8" title="8"><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>B){</a>
<a class="sourceLine" id="cb77-9" title="9">  i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb77-10" title="10">  x &lt;-<span class="st"> </span>scor[i,]</a>
<a class="sourceLine" id="cb77-11" title="11">  theta.boot[b] &lt;-<span class="st"> </span><span class="kw">theta.hat</span>(x)</a>
<a class="sourceLine" id="cb77-12" title="12">}</a>
<a class="sourceLine" id="cb77-13" title="13"></a>
<a class="sourceLine" id="cb77-14" title="14"><span class="co"># Estimate bias and standard error of theta.hat</span></a>
<a class="sourceLine" id="cb77-15" title="15">bias.hat_boot &lt;-<span class="st"> </span><span class="kw">mean</span>(theta.boot) <span class="op">-</span><span class="st"> </span><span class="kw">theta.hat</span>(scor)</a>
<a class="sourceLine" id="cb77-16" title="16">se.hat_boot &lt;-<span class="st"> </span><span class="kw">sd</span>(theta.boot)</a>
<a class="sourceLine" id="cb77-17" title="17"><span class="co"># print the result</span></a>
<a class="sourceLine" id="cb77-18" title="18">bias.hat_boot</a></code></pre></div>
<pre><code>## [1] 0.00141022</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">se.hat_boot</a></code></pre></div>
<pre><code>## [1] 0.04699036</code></pre>
<p>Via jackknife in Exercise 7.8</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb81-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>n){</a>
<a class="sourceLine" id="cb81-3" title="3">  x &lt;-<span class="st"> </span>scor[<span class="op">-</span>i,]</a>
<a class="sourceLine" id="cb81-4" title="4">  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">theta.hat</span>(x)</a>
<a class="sourceLine" id="cb81-5" title="5">}</a>
<a class="sourceLine" id="cb81-6" title="6"></a>
<a class="sourceLine" id="cb81-7" title="7"><span class="co"># Estimate bias and standard error of theta.hat</span></a>
<a class="sourceLine" id="cb81-8" title="8">bias.hat_jack &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span><span class="kw">theta.hat</span>(scor))</a>
<a class="sourceLine" id="cb81-9" title="9">se.hat_jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb81-10" title="10"><span class="co"># print the result</span></a>
<a class="sourceLine" id="cb81-11" title="11">bias.hat_jack</a></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">se.hat_jack</a></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
</div>
<div id="exercise-7.10" class="section level2">
<h2>Exercise 7.10</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
<div id="answer-15" class="section level3">
<h3>answer</h3>
<p>To display four plots</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">library</span>(DAAG)</a>
<a class="sourceLine" id="cb85-2" title="2">magnetic &lt;-<span class="st"> </span>ironslag<span class="op">$</span>magnetic</a>
<a class="sourceLine" id="cb85-3" title="3">chemical &lt;-<span class="st"> </span>ironslag<span class="op">$</span>chemical</a>
<a class="sourceLine" id="cb85-4" title="4">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></a>
<a class="sourceLine" id="cb85-5" title="5"><span class="co">#par(mfrow = c(2,2))</span></a>
<a class="sourceLine" id="cb85-6" title="6"></a>
<a class="sourceLine" id="cb85-7" title="7">L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical) </a>
<a class="sourceLine" id="cb85-8" title="8"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main =</span> <span class="st">&quot;Linear&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>) </a>
<a class="sourceLine" id="cb85-9" title="9">yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a </a>
<a class="sourceLine" id="cb85-10" title="10"><span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main =</span> <span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>) </a>
<a class="sourceLine" id="cb86-3" title="3">yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb86-4" title="4"><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical) </a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main =</span> <span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>) </a>
<a class="sourceLine" id="cb87-3" title="3">logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a </a>
<a class="sourceLine" id="cb87-4" title="4">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) </a>
<a class="sourceLine" id="cb87-5" title="5"><span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main =</span> <span class="st">&quot;cubic&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>) </a>
<a class="sourceLine" id="cb88-3" title="3">yhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb88-4" title="4"><span class="kw">lines</span>(a, yhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Model selected by the cross validation procedure</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag </span></a>
<a class="sourceLine" id="cb89-2" title="2">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb89-3" title="3"><span class="co"># for n-fold cross validation </span></a>
<a class="sourceLine" id="cb89-4" title="4"><span class="co"># fit models on leave-one-out samples </span></a>
<a class="sourceLine" id="cb89-5" title="5"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { </a>
<a class="sourceLine" id="cb89-6" title="6">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k] </a>
<a class="sourceLine" id="cb89-7" title="7">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb89-8" title="8">  </a>
<a class="sourceLine" id="cb89-9" title="9">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb89-10" title="10">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb89-11" title="11">  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb89-12" title="12">  </a>
<a class="sourceLine" id="cb89-13" title="13">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb89-14" title="14">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb89-15" title="15">  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb89-16" title="16">  </a>
<a class="sourceLine" id="cb89-17" title="17">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb89-18" title="18">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb89-19" title="19">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) </a>
<a class="sourceLine" id="cb89-20" title="20">  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb89-21" title="21">  </a>
<a class="sourceLine" id="cb89-22" title="22">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb89-23" title="23">  yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb89-24" title="24">  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb89-25" title="25">} </a>
<a class="sourceLine" id="cb89-26" title="26"><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)) </a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">L2</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>The fitted regression equation for Model 2 is <span class="math inline">\(\hat{Y}\)</span> = 24.4926234 + -1.3933385X + 0.054519<span class="math inline">\(X^2\)</span></p>
<p>Model selected by maximum adjust <span class="math inline">\(R^2\)</span></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag </span></a>
<a class="sourceLine" id="cb93-2" title="2">y &lt;-<span class="st"> </span>magnetic</a>
<a class="sourceLine" id="cb93-3" title="3">x &lt;-<span class="st"> </span>chemical</a>
<a class="sourceLine" id="cb93-4" title="4"></a>
<a class="sourceLine" id="cb93-5" title="5">J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb93-6" title="6"><span class="kw">summary</span>(J1)<span class="op">$</span>adj.r.squared<span class="co"># to get the adjust R^2</span></a></code></pre></div>
<pre><code>## [1] 0.5281545</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">summary</span>(J2)<span class="op">$</span>adj.r.squared</a></code></pre></div>
<pre><code>## [1] 0.5768151</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb97-2" title="2"><span class="kw">summary</span>(J3)<span class="op">$</span>adj.r.squared</a></code></pre></div>
<pre><code>## [1] 0.5280556</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb99-2" title="2"><span class="kw">summary</span>(J4)<span class="op">$</span>adj.r.squared</a></code></pre></div>
<pre><code>## [1] 0.5740396</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">L2</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>The fitted regression equation for Model 2 is <span class="math inline">\(\hat{Y}\)</span> = 24.4926234 + -1.3933385X + 0.054519<span class="math inline">\(X^2\)</span></p>
</div>
</div>
</div>
<div id="section-7" class="section level1">
<h1>8</h1>
<div id="exercise-8.3" class="section level2">
<h2>Exercise 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<div id="answer-16" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="co"># define the function of &quot;count five test&quot;</span></a>
<a class="sourceLine" id="cb103-2" title="2">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb103-3" title="3">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb103-4" title="4">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb103-5" title="5">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb103-6" title="6">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb103-7" title="7">  <span class="co"># get the statistic of &quot;count five test&quot;</span></a>
<a class="sourceLine" id="cb103-8" title="8">  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy))))</a>
<a class="sourceLine" id="cb103-9" title="9">}</a></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="co"># get two samples with the same variance while sample sizes are not equal</span></a>
<a class="sourceLine" id="cb104-2" title="2"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb104-3" title="3">n1 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb104-4" title="4">n2 &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb104-5" title="5">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb104-6" title="6">sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb104-7" title="7">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb104-8" title="8">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb104-9" title="9"><span class="co">#centered by sample mean</span></a>
<a class="sourceLine" id="cb104-10" title="10">x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb104-11" title="11">y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">t0 &lt;-<span class="st"> </span><span class="kw">count5test</span>(x,y)</a>
<a class="sourceLine" id="cb105-2" title="2">R &lt;-<span class="st"> </span><span class="dv">999</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb105-3" title="3">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y) <span class="co">#pooled sample</span></a>
<a class="sourceLine" id="cb105-4" title="4">K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>(n1<span class="op">+</span>n2)</a>
<a class="sourceLine" id="cb105-5" title="5">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R) <span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb105-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb105-7" title="7"><span class="co">#generate indices k for the first sample</span></a>
<a class="sourceLine" id="cb105-8" title="8">k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb105-9" title="9">x1 &lt;-<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb105-10" title="10">y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></a>
<a class="sourceLine" id="cb105-11" title="11">reps[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1, y1)</a>
<a class="sourceLine" id="cb105-12" title="12">}</a>
<a class="sourceLine" id="cb105-13" title="13"><span class="co"># print the p-value</span></a>
<a class="sourceLine" id="cb105-14" title="14"><span class="kw">mean</span>(reps <span class="op">&gt;</span><span class="st"> </span>t0)</a></code></pre></div>
<pre><code>## [1] 0.1411411</code></pre>
</div>
</div>
<div id="dicussion" class="section level2">
<h2>Dicussion</h2>
<ul>
<li><p>Power comparison (distance correlation test versus ball covariance test)</p>
<p>Model 1: <span class="math inline">\(Y=X/4+e\)</span><br />
Model 2: <span class="math inline">\(Y=X/4\times e\)</span><br />
<span class="math inline">\(X\sim N(0_2,I_2)\)</span>, <span class="math inline">\(e\sim N(0_2,I_2)\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(e\)</span> are independent.</p></li>
</ul>
<div id="answer-17" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb107-3" title="3"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb107-4" title="4"></a>
<a class="sourceLine" id="cb107-5" title="5">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb107-6" title="6">  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</a>
<a class="sourceLine" id="cb107-7" title="7">  y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb107-8" title="8">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb107-9" title="9">  m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb107-10" title="10">  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb107-11" title="11">  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb107-12" title="12">    <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb107-13" title="13">  Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb107-14" title="14">    d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb107-15" title="15">    m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d)</a>
<a class="sourceLine" id="cb107-16" title="16">    M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb107-17" title="17">    a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m)</a>
<a class="sourceLine" id="cb107-18" title="18">    b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb107-19" title="19">    <span class="kw">return</span>(b <span class="op">+</span><span class="st"> </span>M)</a>
<a class="sourceLine" id="cb107-20" title="20">  }</a>
<a class="sourceLine" id="cb107-21" title="21">  A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x)</a>
<a class="sourceLine" id="cb107-22" title="22">  B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb107-23" title="23">  dCov &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb107-24" title="24">}</a>
<a class="sourceLine" id="cb107-25" title="25"></a>
<a class="sourceLine" id="cb107-26" title="26">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb107-27" title="27">  <span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb107-28" title="28">  p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb107-29" title="29">  q1 &lt;-<span class="st"> </span>dims[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb107-30" title="30">  d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb107-31" title="31">  x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb107-32" title="32">  y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb107-33" title="33">  <span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb107-34" title="34">}</a>
<a class="sourceLine" id="cb107-35" title="35"></a>
<a class="sourceLine" id="cb107-36" title="36">dc.test &lt;-<span class="st"> </span><span class="cf">function</span>(z, dims){</a>
<a class="sourceLine" id="cb107-37" title="37">  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> R, <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>,  <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb107-38" title="38">  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb107-39" title="39">  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts <span class="op">&gt;=</span><span class="st"> </span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb107-40" title="40">  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>], <span class="dt">p.value=</span>p.value)</a>
<a class="sourceLine" id="cb107-41" title="41">}</a></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb108-2" title="2">m &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb108-3" title="3">u &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb108-4" title="4">sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb108-5" title="5">R &lt;-<span class="st"> </span><span class="fl">1e2</span></a>
<a class="sourceLine" id="cb108-6" title="6">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb108-7" title="7">n &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb108-8" title="8">power.dc &lt;-<span class="st"> </span>power.ball &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb108-9" title="9">p.dc &lt;-<span class="st"> </span>p.ball &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a></code></pre></div>
<p>Model 1: Y = X/4 + e</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb109-2" title="2"> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb109-3" title="3">    x&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[j]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow =</span> n[j])</a>
<a class="sourceLine" id="cb109-4" title="4">    e&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[j]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow =</span> n[j])</a>
<a class="sourceLine" id="cb109-5" title="5">    y &lt;-<span class="st"> </span>x<span class="op">/</span><span class="dv">4</span><span class="op">+</span>e</a>
<a class="sourceLine" id="cb109-6" title="6">    z &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(x,y))</a>
<a class="sourceLine" id="cb109-7" title="7">    p.dc[i] &lt;-<span class="st"> </span><span class="kw">dc.test</span>(z, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb109-8" title="8">    p.ball[i] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(x, y, <span class="dt">R=</span>R, <span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb109-9" title="9">  }</a>
<a class="sourceLine" id="cb109-10" title="10">  power.dc[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.dc <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb109-11" title="11">  power.ball[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.ball <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb109-12" title="12">}</a>
<a class="sourceLine" id="cb109-13" title="13"></a>
<a class="sourceLine" id="cb109-14" title="14"><span class="co"># plot the power</span></a>
<a class="sourceLine" id="cb109-15" title="15"><span class="kw">plot</span>(n, power.dc, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Model 1&quot;</span>, <span class="dt">col =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb109-16" title="16"><span class="kw">lines</span>(n, power.ball, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>, <span class="dt">col =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb109-17" title="17"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;dc&#39;</span>, <span class="st">&#39;ball&#39;</span>), <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Model 2: Y = X/4 * e</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb110-2" title="2">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb110-3" title="3">    x&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[j]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow =</span> n[j])</a>
<a class="sourceLine" id="cb110-4" title="4">    e&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n[j]<span class="op">*</span><span class="dv">2</span>),<span class="dt">nrow =</span> n[j])</a>
<a class="sourceLine" id="cb110-5" title="5">    y &lt;-<span class="st"> </span>x<span class="op">/</span><span class="dv">4</span><span class="op">*</span>e</a>
<a class="sourceLine" id="cb110-6" title="6">    z &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(x,y))</a>
<a class="sourceLine" id="cb110-7" title="7">    p.dc[i] &lt;-<span class="st"> </span><span class="kw">dc.test</span>(z, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb110-8" title="8">    p.ball[i] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(x, y, <span class="dt">R=</span>R, <span class="dt">seed =</span> i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb110-9" title="9">  }</a>
<a class="sourceLine" id="cb110-10" title="10">  power.dc[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.dc <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb110-11" title="11">  power.ball[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(p.ball <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb110-12" title="12">}</a>
<a class="sourceLine" id="cb110-13" title="13"></a>
<a class="sourceLine" id="cb110-14" title="14"><span class="co"># plot the power</span></a>
<a class="sourceLine" id="cb110-15" title="15"><span class="kw">plot</span>(n, power.dc, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Model 1&quot;</span>, <span class="dt">col =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb110-16" title="16"><span class="kw">lines</span>(n, power.ball, <span class="dt">type =</span> <span class="st">&quot;o&quot;</span>, <span class="dt">col =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb110-17" title="17"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;dc&#39;</span>, <span class="st">&#39;ball&#39;</span>), <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As for model 1, “distance correlation test” would be better As for model 2, “ball covariance test” would be better.</p>
</div>
</div>
</div>
<div id="section-8" class="section level1">
<h1>9</h1>
<div id="exercise-9.4" class="section level2">
<h2>Exercise 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<div id="answer-18" class="section level3">
<h3>answer</h3>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x) = \frac{1}{2}e^{-\left | x \right |}, x \in R\)</span></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">laplace &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">lambda =</span> <span class="dv">1</span>){</a>
<a class="sourceLine" id="cb111-2" title="2">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>lambda)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x<span class="op">-</span>mu)<span class="op">/</span>lambda))</a>
<a class="sourceLine" id="cb111-3" title="3">}</a>
<a class="sourceLine" id="cb111-4" title="4"></a>
<a class="sourceLine" id="cb111-5" title="5">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb111-6" title="6">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb111-7" title="7">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb111-8" title="8">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb111-9" title="9">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb111-10" title="10">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb111-11" title="11">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb111-12" title="12">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">laplace</span>(y, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">laplace</span>(x[i<span class="dv">-1</span>], <span class="dv">0</span>, <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb111-13" title="13">      x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb111-14" title="14">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb111-15" title="15">        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb111-16" title="16">        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb111-17" title="17">      }</a>
<a class="sourceLine" id="cb111-18" title="18">  }</a>
<a class="sourceLine" id="cb111-19" title="19">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb111-20" title="20">}</a>
<a class="sourceLine" id="cb111-21" title="21"></a>
<a class="sourceLine" id="cb111-22" title="22"><span class="co">#par(mfrow = c(2,2))</span></a>
<a class="sourceLine" id="cb111-23" title="23">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb111-24" title="24">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb111-25" title="25">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb111-26" title="26">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb111-27" title="27">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb111-28" title="28">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb111-29" title="29">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb111-30" title="30"><span class="co">#number of candidate points rejected</span></a>
<a class="sourceLine" id="cb111-31" title="31">accept &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)<span class="op">/</span>N</a>
<a class="sourceLine" id="cb111-32" title="32"><span class="kw">print</span>(accept)</a></code></pre></div>
<pre><code>## [1] 0.9830 0.8145 0.5280 0.1105</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">plot</span>(rw1<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;accept rate = &quot;</span>,accept[<span class="dv">1</span>]), <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma = &quot;</span>,sigma[<span class="dv">1</span>]), <span class="dt">ylab =</span> <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb113-2" title="2"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>), <span class="op">-</span><span class="kw">log</span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>)), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">plot</span>(rw2<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;accept rate = &quot;</span>,accept[<span class="dv">2</span>]), <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma = &quot;</span>,sigma[<span class="dv">2</span>]), <span class="dt">ylab =</span> <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb114-2" title="2"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>), <span class="op">-</span><span class="kw">log</span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>)), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">plot</span>(rw3<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;accept rate = &quot;</span>,accept[<span class="dv">3</span>]), <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma = &quot;</span>,sigma[<span class="dv">3</span>]), <span class="dt">ylab =</span> <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb115-2" title="2"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>), <span class="op">-</span><span class="kw">log</span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>)), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">plot</span>(rw4<span class="op">$</span>x, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;accept rate = &quot;</span>,accept[<span class="dv">4</span>]), <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma = &quot;</span>,sigma[<span class="dv">4</span>]), <span class="dt">ylab =</span> <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb116-2" title="2"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">c</span>(<span class="kw">log</span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>), <span class="op">-</span><span class="kw">log</span>(<span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>)), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the first plot of Figure with <span class="math inline">\(\sigma = 0.05\)</span>, the ratios <span class="math inline">\(r(X_t,Y)\)</span> tend to be large and almost every candidate point is accepted. The increments are small and the chain is almost like a true random walk. Chain 1 has not converged to the target in 2000 iterations. The chain in the second plot generated with <span class="math inline">\(\sigma = 0.5\)</span> is converging little slowly, and very few points are rejected. In the third plot <span class="math inline">\(\sigma = 2\)</span> the chain is mixing well and converging to the target distribution after a short burn-in period of about 50. Finally, in the fourth plot, where <span class="math inline">\(\sigma = 16\)</span>, the ratios <span class="math inline">\(r(X_t,Y)\)</span> are smaller and most of the candidate points are rejected. The fourth chain converges, but it is inefficient.</p>
</div>
</div>
</div>
<div id="section-9" class="section level1">
<h1>10</h1>
<div id="exercises-11.1" class="section level2">
<h2>Exercises 11.1</h2>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x) = exp(log x) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
<div id="answer-19" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">x &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb117-2" title="2"><span class="kw">log</span>(<span class="kw">exp</span>(x)) <span class="op">==</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">log</span>(x))</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x)), <span class="kw">exp</span>(<span class="kw">log</span>(x))))</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
</div>
<div id="exercises-11.5" class="section level2">
<h2>Exercises 11.5</h2>
<p>Write a function to solve the equation <span class="math inline">\(\frac{2\Gamma (\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_{0}^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du\)</span> = <span class="math inline">\(\frac{2\Gamma (\frac{k+1}{2})}{\sqrt{\pi k}\Gamma (\frac{k}{2})}\int_{0}^{c_k}(1+\frac{u^2}{k})^{-(k+1)/2}du\)</span> for a, where <span class="math inline">\(c_k = \sqrt{\frac{a^2 k}{k+1-a^2}}\)</span> compare the solutions with the points A(k) in Exercise 11.4</p>
<div id="answer-20" class="section level3">
<h3>answer</h3>
<p>Exercise 11.4 Find the intersection points A(k) in (0, <span class="math inline">\(\sqrt{k}\)</span>) of the curves <span class="math inline">\(S_{k-1}(a) = P(t(k-1) &gt; \sqrt{\frac{a^2(k-1)}{k-a^2}})\)</span> and <span class="math inline">\(S_{k}(a) = P(t(k) &gt; \sqrt{\frac{a^2(k)}{k+1-a^2}})\)</span> for k = 4 : 25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Szekely [260].)</p>
<p>The solution of exercise 11.4 as followed:</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb121-2" title="2">r1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb121-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</a>
<a class="sourceLine" id="cb121-4" title="4">  ki &lt;-<span class="st"> </span>k[i]</a>
<a class="sourceLine" id="cb121-5" title="5">  ck &lt;-<span class="st"> </span><span class="cf">function</span>(a, ki){</a>
<a class="sourceLine" id="cb121-6" title="6">    <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>ki<span class="op">/</span>(ki<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb121-7" title="7">  }</a>
<a class="sourceLine" id="cb121-8" title="8"></a>
<a class="sourceLine" id="cb121-9" title="9">  s &lt;-<span class="st"> </span><span class="cf">function</span>(a, ki){</a>
<a class="sourceLine" id="cb121-10" title="10">    <span class="kw">pt</span>(<span class="kw">ck</span>(a, ki), <span class="dt">df=</span>ki) <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">ck</span>(a, ki<span class="dv">-1</span>), <span class="dt">df=</span>ki<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb121-11" title="11">  }</a>
<a class="sourceLine" id="cb121-12" title="12">  </a>
<a class="sourceLine" id="cb121-13" title="13">  f &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb121-14" title="14">    <span class="kw">return</span>(<span class="kw">s</span>(a,ki))</a>
<a class="sourceLine" id="cb121-15" title="15">  }</a>
<a class="sourceLine" id="cb121-16" title="16">  r1[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f, <span class="dt">lower =</span> <span class="fl">1e-6</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(ki)<span class="op">-</span><span class="fl">1e-6</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb121-17" title="17">}</a>
<a class="sourceLine" id="cb121-18" title="18">r1</a></code></pre></div>
<pre><code>##  [1]  1.492103  1.533549  1.562768  1.584421  1.601182  1.614517  1.625406
##  [8]  1.634409  1.642026  1.648511  1.654174  1.659121  1.663442  1.667288
## [15]  1.670736  1.673841  1.676589  1.679139  1.681461  4.795831  4.898978
## [22]  4.999999  9.999999 22.360679 31.622776</code></pre>
<p>solution for exercise 11.5</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb123-2" title="2">r2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb123-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</a>
<a class="sourceLine" id="cb123-4" title="4">  ki &lt;-<span class="st"> </span>k[i]</a>
<a class="sourceLine" id="cb123-5" title="5">  </a>
<a class="sourceLine" id="cb123-6" title="6">  h &lt;-<span class="st"> </span><span class="cf">function</span>(a, ki){</a>
<a class="sourceLine" id="cb123-7" title="7">    ck &lt;-<span class="st"> </span><span class="cf">function</span>(a, ki){</a>
<a class="sourceLine" id="cb123-8" title="8">       <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>ki<span class="op">/</span>(ki<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb123-9" title="9">    } </a>
<a class="sourceLine" id="cb123-10" title="10">    </a>
<a class="sourceLine" id="cb123-11" title="11">    g &lt;-<span class="st"> </span><span class="cf">function</span>(u){</a>
<a class="sourceLine" id="cb123-12" title="12">      (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>ki)<span class="op">^</span>(<span class="op">-</span>(ki<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb123-13" title="13">    }</a>
<a class="sourceLine" id="cb123-14" title="14">    </a>
<a class="sourceLine" id="cb123-15" title="15">    <span class="co"># for simplily, get the log of the function</span></a>
<a class="sourceLine" id="cb123-16" title="16">    r&lt;-<span class="kw">lgamma</span>((ki<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">log</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>ki))<span class="op">-</span><span class="kw">lgamma</span>(ki<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">log</span>(<span class="kw">integrate</span>(g, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper=</span><span class="kw">ck</span>(a,ki), <span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>)<span class="op">$</span>value)</a>
<a class="sourceLine" id="cb123-17" title="17">    <span class="kw">return</span>(r)</a>
<a class="sourceLine" id="cb123-18" title="18">  }</a>
<a class="sourceLine" id="cb123-19" title="19">  </a>
<a class="sourceLine" id="cb123-20" title="20">  f &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb123-21" title="21">    <span class="kw">h</span>(a, ki) <span class="op">-</span><span class="st"> </span><span class="kw">h</span>(a, ki<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb123-22" title="22">  }</a>
<a class="sourceLine" id="cb123-23" title="23">  r2[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f, <span class="dt">lower =</span> <span class="fl">1e-7</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(ki)<span class="op">-</span><span class="fl">0.15</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb123-24" title="24">}</a>
<a class="sourceLine" id="cb123-25" title="25">r2</a></code></pre></div>
<pre><code>##  [1] 1.492076 1.533559 1.562747 1.584429 1.601182 1.614519 1.625385 1.634409
##  [9] 1.642054 1.648568 1.654176 1.659104 1.663454 1.667267 1.670724 1.673818
## [17] 1.676614 1.679154 1.681490 1.683572 1.685538 1.687346</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1">ki &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb125-2" title="2">r3 &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f, <span class="dt">lower =</span> <span class="fl">1e-7</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(ki)<span class="op">-</span><span class="dv">3</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb125-3" title="3">r3</a></code></pre></div>
<pre><code>## [1] 1.720575</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">ki &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb127-2" title="2">r4 &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f, <span class="dt">lower =</span> <span class="fl">1e-7</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(ki)<span class="op">-</span><span class="dv">20</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb127-3" title="3">r4</a></code></pre></div>
<pre><code>## [1] 1.729747</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">ki &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb129-2" title="2">r5 &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f, <span class="dt">lower =</span> <span class="fl">1e-7</span>, <span class="dt">upper =</span> <span class="kw">sqrt</span>(ki)<span class="op">-</span><span class="dv">26</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb129-3" title="3">r5</a></code></pre></div>
<pre><code>## [1] 1.730895</code></pre>
<p>Compare with the result in 11.4, can find that the solution are near equal when k is small such as from 4 to 20, but when k is lager enough, the result is not good.</p>
</div>
</div>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<ul>
<li><p>Let the three alleles be A, B, and O with allele frequencies p, q, and r. The 6 genotype frequencies under HWE and complete counts are as follows.</p>
<ul>
<li><p>Observed data: <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=28\)</span> (A-type), <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=24\)</span> (B-type), <span class="math inline">\(n_{OO}=41\)</span> (O-type), <span class="math inline">\(n_{AB}=70\)</span> (AB-type).</p></li>
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p></li>
<li><p>Record the log-maximum likelihood values in M-steps, are they increasing?</p></li>
</ul></li>
</ul>
<div id="answer-21" class="section level3">
<h3>answer</h3>
<p>denote <span class="math inline">\(x = (n_A, n_B, n_{AB}, n_O)\)</span>, $y = (n_{AA}, n_{AO}, n_{BB}, n_{BO}, n_{OO}) the likelihood function of y is <span class="math inline">\(log f(y|P)\)</span> = <span class="math inline">\(n_{AA}log(p^2) + n_{AO}log(2pr) + n_{BB}log(q^2) + n_{BO}log(2qr) + n_{AB}log(pq) + n_{OO}log(r^2) + log\frac{n!}{n_{AA}! n_{AO}! n_{BB}! n_{BO}! n_{AB}! n_{OO}!}\)</span></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="co"># define the function to compute n!</span></a>
<a class="sourceLine" id="cb131-2" title="2">pro &lt;-<span class="st"> </span><span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb131-3" title="3">  <span class="cf">if</span>(n<span class="op">&lt;</span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb131-4" title="4">    <span class="kw">print</span>(<span class="st">&quot;warning: your input is wrong!&quot;</span>)</a>
<a class="sourceLine" id="cb131-5" title="5">  <span class="cf">else</span> <span class="cf">if</span>(n<span class="op">==</span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb131-6" title="6">    <span class="kw">print</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb131-7" title="7">  <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb131-8" title="8">    s &lt;-<span class="st"> </span><span class="kw">length</span>(n)</a>
<a class="sourceLine" id="cb131-9" title="9">    s[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb131-10" title="10">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb131-11" title="11">      s[i] &lt;-<span class="st"> </span>i<span class="op">*</span>s[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb131-12" title="12">    }</a>
<a class="sourceLine" id="cb131-13" title="13">    <span class="kw">return</span>(s[n])</a>
<a class="sourceLine" id="cb131-14" title="14">  }</a>
<a class="sourceLine" id="cb131-15" title="15">}</a></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="co"># Use EM algorithm to solve MLE of p and q </span></a>
<a class="sourceLine" id="cb132-2" title="2">blood &lt;-<span class="st"> </span><span class="cf">function</span>(P, n.obs){</a>
<a class="sourceLine" id="cb132-3" title="3">  n &lt;-<span class="st"> </span><span class="kw">sum</span>(n.obs)</a>
<a class="sourceLine" id="cb132-4" title="4">  na &lt;-<span class="st"> </span>n.obs[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb132-5" title="5">  nb &lt;-<span class="st"> </span>n.obs[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb132-6" title="6">  nab &lt;-<span class="st"> </span>n.obs[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb132-7" title="7">  no &lt;-<span class="st"> </span>n.obs[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb132-8" title="8">  noo &lt;-<span class="st"> </span>no</a>
<a class="sourceLine" id="cb132-9" title="9">  </a>
<a class="sourceLine" id="cb132-10" title="10">  <span class="co">## E step</span></a>
<a class="sourceLine" id="cb132-11" title="11"><span class="co">#  cat(P, &quot;\n&quot;)  # P is the vector of original probability c(p,q,r)</span></a>
<a class="sourceLine" id="cb132-12" title="12">  p &lt;-<span class="st"> </span>q &lt;-<span class="st"> </span>r &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, m)</a>
<a class="sourceLine" id="cb132-13" title="13">  lnf &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, m<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb132-14" title="14">  p[<span class="dv">1</span>] &lt;-<span class="st"> </span>P[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb132-15" title="15">  q[<span class="dv">1</span>] &lt;-<span class="st"> </span>P[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb132-16" title="16">  r[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>P[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>P[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb132-17" title="17">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb132-18" title="18">    <span class="co"># instead old value by new value</span></a>
<a class="sourceLine" id="cb132-19" title="19">    p.old &lt;-<span class="st"> </span>p[i<span class="dv">-1</span>]  </a>
<a class="sourceLine" id="cb132-20" title="20">    q.old &lt;-<span class="st"> </span>q[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb132-21" title="21">    r.old &lt;-<span class="st"> </span>r[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb132-22" title="22">    </a>
<a class="sourceLine" id="cb132-23" title="23">    <span class="co">## M step</span></a>
<a class="sourceLine" id="cb132-24" title="24">    den1 &lt;-<span class="st"> </span>p.old<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>p.old <span class="op">*</span><span class="st"> </span>r.old</a>
<a class="sourceLine" id="cb132-25" title="25">    naa &lt;-<span class="st"> </span>na <span class="op">*</span><span class="st"> </span>p.old<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>den1</a>
<a class="sourceLine" id="cb132-26" title="26">    nao &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>na <span class="op">*</span><span class="st"> </span>p.old <span class="op">*</span><span class="st"> </span>r.old <span class="op">/</span><span class="st"> </span>den1</a>
<a class="sourceLine" id="cb132-27" title="27">    den2 &lt;-<span class="st"> </span>q.old<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>q.old <span class="op">*</span><span class="st"> </span>r.old</a>
<a class="sourceLine" id="cb132-28" title="28">    nbb &lt;-<span class="st"> </span>nb <span class="op">*</span><span class="st"> </span>q.old<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>den2</a>
<a class="sourceLine" id="cb132-29" title="29">    nbo &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>nb <span class="op">*</span><span class="st"> </span>q.old <span class="op">*</span><span class="st"> </span>r.old <span class="op">/</span><span class="st"> </span>den2</a>
<a class="sourceLine" id="cb132-30" title="30">    p[i] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>naa <span class="op">+</span><span class="st"> </span>nao <span class="op">+</span><span class="st"> </span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb132-31" title="31">    q[i] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nbb <span class="op">+</span><span class="st"> </span>nbo <span class="op">+</span><span class="st"> </span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb132-32" title="32">    r[i] &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>noo <span class="op">+</span><span class="st"> </span>nao <span class="op">+</span><span class="st"> </span>nbo)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb132-33" title="33">    lnf[i<span class="dv">-1</span>] &lt;-<span class="st"> </span>naa<span class="op">*</span><span class="kw">log</span>(p[i]<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>nao<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[i]<span class="op">*</span>r[i])<span class="op">+</span>nbb<span class="op">*</span><span class="kw">log</span>(q[i]<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>nbo<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q[i]<span class="op">*</span>r[i])<span class="op">+</span>nab<span class="op">*</span><span class="kw">log</span>(p[i]<span class="op">*</span>q[i])<span class="op">+</span>noo<span class="op">*</span><span class="kw">log</span>(r[i]<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">log</span>(<span class="kw">pro</span>(n)<span class="op">/</span>(<span class="kw">pro</span>(naa)<span class="op">*</span><span class="kw">pro</span>(nao)<span class="op">*</span><span class="kw">pro</span>(nbb)<span class="op">*</span><span class="kw">pro</span>(nbo)<span class="op">*</span><span class="kw">pro</span>(nab)<span class="op">*</span><span class="kw">pro</span>(noo)))</a>
<a class="sourceLine" id="cb132-34" title="34">  }</a>
<a class="sourceLine" id="cb132-35" title="35">  </a>
<a class="sourceLine" id="cb132-36" title="36">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">P =</span> <span class="kw">c</span>(p[m], q[m], r[m]), <span class="dt">lh =</span> lnf[<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>]))  <span class="co"># return the first 50 values</span></a>
<a class="sourceLine" id="cb132-37" title="37">}</a>
<a class="sourceLine" id="cb132-38" title="38">n.obs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">28</span>, <span class="dv">24</span>, <span class="dv">70</span>, <span class="dv">41</span>)</a>
<a class="sourceLine" id="cb132-39" title="39">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#repicate times</span></a>
<a class="sourceLine" id="cb132-40" title="40">P &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)  <span class="co"># set the original value</span></a>
<a class="sourceLine" id="cb132-41" title="41"></a>
<a class="sourceLine" id="cb132-42" title="42">c &lt;-<span class="st"> </span><span class="kw">blood</span>(P, n.obs)</a>
<a class="sourceLine" id="cb132-43" title="43">c<span class="op">$</span>P</a></code></pre></div>
<pre><code>## [1] 0.3273442 0.3104267 0.3622291</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="co">#c$lh</span></a>
<a class="sourceLine" id="cb134-2" title="2"><span class="kw">plot</span>(c<span class="op">$</span>lh, <span class="dt">xlab=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;likelihood&quot;</span>, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">col=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Convergence times are 20, and from the table, we can know that p is converged to 0.32734, q is converged to 0.31043.</p>
</div>
</div>
</div>
<div id="section-10" class="section level1">
<h1>11</h1>
<div id="exercise-3-p204" class="section level2">
<h2>Exercise 3 (P204)</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:<br />
formulas &lt;- list(<br />
mpg ~ disp,<br />
mpg ~ I(1 / disp),<br />
mpg ~ disp + wt,<br />
mpg ~ I(1 / disp) + wt<br />
)</p>
<div id="answer-22" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(    </a>
<a class="sourceLine" id="cb135-2" title="2">  mpg <span class="op">~</span><span class="st"> </span>disp,     </a>
<a class="sourceLine" id="cb135-3" title="3">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),    </a>
<a class="sourceLine" id="cb135-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,    </a>
<a class="sourceLine" id="cb135-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt    </a>
<a class="sourceLine" id="cb135-6" title="6">) </a>
<a class="sourceLine" id="cb135-7" title="7"></a>
<a class="sourceLine" id="cb135-8" title="8"><span class="co"># use for loops</span></a>
<a class="sourceLine" id="cb135-9" title="9">r1 &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb135-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb135-11" title="11">  r1[[i]]  &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> formulas[[i]], <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb135-12" title="12">}</a>
<a class="sourceLine" id="cb135-13" title="13">r1</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="co"># use lapply()</span></a>
<a class="sourceLine" id="cb137-2" title="2">r2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(formulas){</a>
<a class="sourceLine" id="cb137-3" title="3">  <span class="kw">lm</span>(<span class="dt">formula =</span> formulas, <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb137-4" title="4">})</a>
<a class="sourceLine" id="cb137-5" title="5">r2</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>Results by using for loops and lapply are same.</p>
</div>
</div>
<div id="exercise-4-p204" class="section level2">
<h2>Exercise 4 (P204)</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?</p>
<div id="answer-23" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {    </a>
<a class="sourceLine" id="cb139-2" title="2">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="st"> </span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)     </a>
<a class="sourceLine" id="cb139-3" title="3">  mtcars[rows, ]     </a>
<a class="sourceLine" id="cb139-4" title="4">}) </a>
<a class="sourceLine" id="cb139-5" title="5"></a>
<a class="sourceLine" id="cb139-6" title="6"><span class="co"># use for loops</span></a>
<a class="sourceLine" id="cb139-7" title="7">r3 &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb139-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb139-9" title="9">r3[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> bootstraps[[i]])</a>
<a class="sourceLine" id="cb139-10" title="10">}</a>
<a class="sourceLine" id="cb139-11" title="11">r3</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.34891     -0.03979  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##      29.941       -0.043  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.5716      -0.0415  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.41031     -0.03424  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.52423     -0.05173  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.47975     -0.04481  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.9241      -0.0448  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.73072     -0.04667  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.41999     -0.03302  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.38313     -0.04404</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="co"># use lapply</span></a>
<a class="sourceLine" id="cb141-2" title="2">r4 &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, <span class="cf">function</span>(x) <span class="kw">lm</span>(<span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> x))</a>
<a class="sourceLine" id="cb141-3" title="3">r4</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.34891     -0.03979  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##      29.941       -0.043  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##     28.5716      -0.0415  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    27.41031     -0.03424  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    31.52423     -0.05173  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.47975     -0.04481  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##     29.9241      -0.0448  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.73072     -0.04667  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    26.41999     -0.03302  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.38313     -0.04404</code></pre>
<p>Results by using two methods are same.</p>
</div>
</div>
<div id="exercise-5-p204" class="section level2">
<h2>Exercise 5 (P204)</h2>
<p>For each model in the previous two exercises, extract R2 using the function below.<br />
rsq &lt;- function(mod) summary(mod)$r.squared</p>
<div id="answer-24" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared </a>
<a class="sourceLine" id="cb143-2" title="2">R1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(r1, rsq)</a>
<a class="sourceLine" id="cb143-3" title="3">R1</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1">R2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(r2, rsq)</a>
<a class="sourceLine" id="cb145-2" title="2">R2</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">R3 &lt;-<span class="st"> </span><span class="kw">lapply</span>(r3, rsq)</a>
<a class="sourceLine" id="cb147-2" title="2">R3</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.8318015
## 
## [[2]]
## [1] 0.7579137
## 
## [[3]]
## [1] 0.7997845
## 
## [[4]]
## [1] 0.5636278
## 
## [[5]]
## [1] 0.7332603
## 
## [[6]]
## [1] 0.7086225
## 
## [[7]]
## [1] 0.7622925
## 
## [[8]]
## [1] 0.8105539
## 
## [[9]]
## [1] 0.7108513
## 
## [[10]]
## [1] 0.6902462</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">R4 &lt;-<span class="st"> </span><span class="kw">lapply</span>(r4, rsq)</a>
<a class="sourceLine" id="cb149-2" title="2">R4</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.8318015
## 
## [[2]]
## [1] 0.7579137
## 
## [[3]]
## [1] 0.7997845
## 
## [[4]]
## [1] 0.5636278
## 
## [[5]]
## [1] 0.7332603
## 
## [[6]]
## [1] 0.7086225
## 
## [[7]]
## [1] 0.7622925
## 
## [[8]]
## [1] 0.8105539
## 
## [[9]]
## [1] 0.7108513
## 
## [[10]]
## [1] 0.6902462</code></pre>
</div>
</div>
<div id="exercise-3-p214" class="section level2">
<h2>Exercise 3 (P214)</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.<br />
trials &lt;- replicate(100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE)<br />
Extra challenge: get rid of the anonymous function by using [[ directly.</p>
<div id="answer-25" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), <span class="dt">simplify =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb151-2" title="2"><span class="co"># use sapply</span></a>
<a class="sourceLine" id="cb151-3" title="3">p1 &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb151-4" title="4">p1</a></code></pre></div>
<pre><code>##   [1] 0.177553389 0.645900556 0.405204448 0.261542040 0.395000063 0.511295100
##   [7] 0.731726676 0.292777824 0.279296117 0.917575793 0.127791373 0.612046878
##  [13] 0.119924862 0.885400781 0.180010105 0.292632405 0.155923001 0.374152836
##  [19] 0.301010540 0.810104750 0.231392231 0.673027227 0.018326792 0.804004091
##  [25] 0.635468120 0.749321604 0.707371452 0.272922687 0.257012757 0.087843270
##  [31] 0.426785019 0.396809377 0.096857103 0.246896998 0.212570064 0.340915631
##  [37] 0.128589601 0.908053478 0.473965895 0.635159601 0.542049473 0.628098014
##  [43] 0.290575053 0.379755942 0.425396254 0.109022541 0.765262549 0.029318152
##  [49] 0.161142391 0.648351139 0.006866725 0.320098094 0.641822042 0.977959796
##  [55] 0.317714277 0.122085392 0.348221595 0.003914280 0.323871502 0.847691966
##  [61] 0.664879338 0.169666489 0.114353739 0.753354454 0.727444562 0.591625052
##  [67] 0.229431859 0.657560384 0.846588358 0.799557049 0.242671690 0.100014756
##  [73] 0.661402291 0.084518245 0.076414974 0.268952858 0.152859227 0.405693778
##  [79] 0.634904528 0.140875668 0.779453011 0.682896089 0.714919015 0.542484597
##  [85] 0.520081039 0.637485317 0.646642429 0.259043200 0.190740394 0.084319668
##  [91] 0.602544215 0.596269215 0.271421976 0.373611901 0.676898787 0.236010025
##  [97] 0.337512821 0.161442372 0.905386179 0.826823753</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1"><span class="co"># use for loops</span></a>
<a class="sourceLine" id="cb153-2" title="2">p2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb153-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb153-4" title="4">p2[i] &lt;-<span class="st"> </span>trials[[i]]<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb153-5" title="5">}</a></code></pre></div>
</div>
</div>
<div id="exercise-7-p214" class="section level2">
<h2>Exercise 7 (P214)</h2>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
<div id="answer-26" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb154-2" title="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">c</span>(<span class="kw">sum</span>(x), <span class="kw">mean</span>(x), <span class="kw">sd</span>(x))</a>
<a class="sourceLine" id="cb154-3" title="3">x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>,<span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb154-4" title="4"></a>
<a class="sourceLine" id="cb154-5" title="5"><span class="co"># use mcsapply</span></a>
<a class="sourceLine" id="cb154-6" title="6">mcsapply &lt;-<span class="st"> </span><span class="cf">function</span>(x, f){</a>
<a class="sourceLine" id="cb154-7" title="7">  cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb154-8" title="8">  result &lt;-<span class="st"> </span><span class="kw">parLapply</span>(cl, x, f)</a>
<a class="sourceLine" id="cb154-9" title="9">  <span class="kw">stopCluster</span>(cl) </a>
<a class="sourceLine" id="cb154-10" title="10">  <span class="kw">return</span>(<span class="kw">unlist</span>(result))</a>
<a class="sourceLine" id="cb154-11" title="11">}</a>
<a class="sourceLine" id="cb154-12" title="12"><span class="co"># print the system.time</span></a>
<a class="sourceLine" id="cb154-13" title="13"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(x, f))  </a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.03 0.79</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="co"># use mcvapply</span></a>
<a class="sourceLine" id="cb156-2" title="2">mcvapply &lt;-<span class="st"> </span><span class="cf">function</span>(x, f){</a>
<a class="sourceLine" id="cb156-3" title="3">  cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb156-4" title="4">  result &lt;-<span class="st"> </span><span class="kw">vapply</span>(x,f,<span class="kw">c</span>(<span class="st">&quot;a&quot;</span> =<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;b&quot;</span> =<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;c&quot;</span> =<span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb156-5" title="5">  <span class="kw">stopCluster</span>(cl) </a>
<a class="sourceLine" id="cb156-6" title="6">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb156-7" title="7">}</a>
<a class="sourceLine" id="cb156-8" title="8"><span class="co"># print the system.time</span></a>
<a class="sourceLine" id="cb156-9" title="9"><span class="kw">system.time</span>(<span class="kw">mcvapply</span>(x, f))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.02 0.00 1.01</code></pre>
</div>
</div>
</div>
<div id="section-11" class="section level1">
<h1>12</h1>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task. * Compare the generated random numbers by the two functions using qqplot. * Campare the computation time of the two functions with microbenchmark. * Comments your results.</p>
<div id="answer-27" class="section level3">
<h3>answer</h3>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x) = \frac{1}{2}e^{-\left | x \right |}, x \in R\)</span></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"><span class="co"># R function</span></a>
<a class="sourceLine" id="cb158-2" title="2"></a>
<a class="sourceLine" id="cb158-3" title="3">laplace &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">mu =</span> <span class="dv">0</span>, <span class="dt">lambda =</span> <span class="dv">1</span>){</a>
<a class="sourceLine" id="cb158-4" title="4">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>lambda)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x<span class="op">-</span>mu)<span class="op">/</span>lambda))</a>
<a class="sourceLine" id="cb158-5" title="5">}</a>
<a class="sourceLine" id="cb158-6" title="6"></a>
<a class="sourceLine" id="cb158-7" title="7">rw &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb158-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb158-9" title="9">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb158-10" title="10">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb158-11" title="11">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb158-12" title="12">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb158-13" title="13">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb158-14" title="14">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">laplace</span>(y, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">laplace</span>(x[i<span class="dv">-1</span>], <span class="dv">0</span>, <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb158-15" title="15">      x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb158-16" title="16">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb158-17" title="17">        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb158-18" title="18">        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb158-19" title="19">      }</a>
<a class="sourceLine" id="cb158-20" title="20">  }</a>
<a class="sourceLine" id="cb158-21" title="21">  <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb158-22" title="22">}</a>
<a class="sourceLine" id="cb158-23" title="23"></a>
<a class="sourceLine" id="cb158-24" title="24"></a>
<a class="sourceLine" id="cb158-25" title="25"><span class="co"># Cpp function</span></a>
<a class="sourceLine" id="cb158-26" title="26"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb158-27" title="27"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb158-28" title="28"><span class="kw">cppFunction</span>(<span class="st">&#39;NumericVector rwC(double sigma, double x_0,int N) {</span></a>
<a class="sourceLine" id="cb158-29" title="29"><span class="st">  NumericVector x(N);</span></a>
<a class="sourceLine" id="cb158-30" title="30"><span class="st">  NumericVector U=runif(N,0,1);</span></a>
<a class="sourceLine" id="cb158-31" title="31"><span class="st">  x(0)=x_0; </span></a>
<a class="sourceLine" id="cb158-32" title="32"><span class="st">  double y;double a;double b;</span></a>
<a class="sourceLine" id="cb158-33" title="33"><span class="st">  for (int i=1; i&lt;N; i++){</span></a>
<a class="sourceLine" id="cb158-34" title="34"><span class="st">    y = rnorm(1,x(i-1),sigma)[0];</span></a>
<a class="sourceLine" id="cb158-35" title="35"><span class="st">    a = 0.5 * exp(-abs(y));</span></a>
<a class="sourceLine" id="cb158-36" title="36"><span class="st">    b = 0.5 * exp(-abs(x(i-1)));</span></a>
<a class="sourceLine" id="cb158-37" title="37"><span class="st">    if (U[i] &lt;= a/b){</span></a>
<a class="sourceLine" id="cb158-38" title="38"><span class="st">      x(i) = y;</span></a>
<a class="sourceLine" id="cb158-39" title="39"><span class="st">    }</span></a>
<a class="sourceLine" id="cb158-40" title="40"><span class="st">    else{</span></a>
<a class="sourceLine" id="cb158-41" title="41"><span class="st">      x(i)=x(i-1);</span></a>
<a class="sourceLine" id="cb158-42" title="42"><span class="st">    }</span></a>
<a class="sourceLine" id="cb158-43" title="43"><span class="st">  }</span></a>
<a class="sourceLine" id="cb158-44" title="44"><span class="st">  return x;</span></a>
<a class="sourceLine" id="cb158-45" title="45"><span class="st">}</span></a>
<a class="sourceLine" id="cb158-46" title="46"><span class="st">&#39;</span>)</a>
<a class="sourceLine" id="cb158-47" title="47"></a>
<a class="sourceLine" id="cb158-48" title="48"><span class="co"># define variables</span></a>
<a class="sourceLine" id="cb158-49" title="49">N &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb158-50" title="50">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb158-51" title="51">x0 &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb158-52" title="52"><span class="co">#par(mfrow = c(2,2))</span></a>
<a class="sourceLine" id="cb158-53" title="53"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb158-54" title="54">  <span class="co"># qqplot:</span></a>
<a class="sourceLine" id="cb158-55" title="55">  r &lt;-<span class="st"> </span><span class="kw">rw</span>(sigma[i],x0,N)</a>
<a class="sourceLine" id="cb158-56" title="56">  R &lt;-<span class="st"> </span><span class="kw">as.vector</span>(r)</a>
<a class="sourceLine" id="cb158-57" title="57">  C &lt;-<span class="st"> </span><span class="kw">rwC</span>(sigma[i],x0,N)</a>
<a class="sourceLine" id="cb158-58" title="58">  <span class="kw">qqplot</span>(R,C, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma = &quot;</span>,sigma[i]))</a>
<a class="sourceLine" id="cb158-59" title="59">  <span class="kw">points</span>(<span class="dt">x=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">6</span>), <span class="dt">y=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">8</span>,<span class="dv">6</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb158-60" title="60">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb159-2" title="2">  <span class="co"># compare two function:</span></a>
<a class="sourceLine" id="cb159-3" title="3">  ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">R=</span><span class="kw">rw</span>(sigma[i],x0,N), <span class="dt">Cpp=</span><span class="kw">rwC</span>(sigma[i],x0,N))</a>
<a class="sourceLine" id="cb159-4" title="4">  <span class="kw">print</span>(<span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</a>
<a class="sourceLine" id="cb159-5" title="5">}</a></code></pre></div>
<pre><code>##   expr        lq   median        uq
## 1    R 29.577951 30.17485 30.470351
## 2  Cpp  1.149701  1.16820  1.186101
##   expr        lq    median        uq
## 1    R 29.836952 30.348450 30.845001
## 2  Cpp  1.329152  1.341651  1.363151
##   expr      lq    median       uq
## 1    R 30.2026 30.599701 30.90930
## 2  Cpp  1.3521  1.365551  1.38125
##   expr        lq    median       uq
## 1    R 29.904801 30.455201 30.73240
## 2  Cpp  1.347301  1.354601  1.36745</code></pre>
<p>From the above, we can find that the result of R and Cpp function are almost same, but the computition cost of R is more expensive, so if it is possible, we’d better to choose Cpp function to solve the question.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
